# システム要件定義書 - Instagram投稿生成システム

## 🎯 システム設計思想

### **核心理念**
各コンポーネントが独立性を保ちながら、IDベース連携により完璧に協調動作するシステム。投稿タイプID + テーマID + ペルソナIDの三次元連携が全システム共通言語となり、テーマを核心とした有益性確定により最適な結果が得られる設計。

## 📊 ユーザーフロー設計

### **理想的なユーザー体験**
```
1. 投稿タイプ選択
   ユーザー: "学習型" を選択
   
2. テーマ選択  
   システム: 学習型に紐づくテーマリストを表示
   ユーザー: "ES書き方" を選択
   
3. ペルソナ選択（テーマ連携 + 1:N柔軟性）
   システム: "ES書き方"に紐づく基本ペルソナ + 有益性一致類似ペルソナ（一致の根拠は有益性の一致）を表示
   - 基本: ES書き方専用ペルソナ（理論上1つ）
   - 類似: 有益性で一致している関連ペルソナ（N連携）
   ユーザー: 最適ペルソナを選択
   
4. 有益性確定
   システム: 選択されたペルソナにより有益性が自動確定
   - リサーチ要件: どのような情報を求めているか
   - 表現要件: ページ構成・文章量・コピー・順序
   
5. タイトル入力
   ユーザー: "人事が絶対見るESの書き方5ステップ" 入力
   
6. リサーチ実行 
   → 確定した有益性 + TypeID + PersonaID + Title でリサーチプロンプト生成・実行
   
```

## 🏗️ システムアーキテクチャ

### **IDベース三次元連携システム**
```
投稿タイプID (TypeID) + テーマID (ThemeID) + ペルソナID (PersonaID) = システム共通言語

例: TypeID=002(学習型) + ThemeID=001(ES書き方) + PersonaID=015(方法論重視型)
→ テーマを核心とした有益性確定により全コンポーネントが最適化動作
```

### **データ構造設計**
```
投稿タイプ管理:
├─ TypeID=001: 共感型
├─ TypeID=002: 学習型  
├─ TypeID=003: 情報型
└─ TypeID=004: 実用型

テーマ管理（投稿タイプ連携）:
├─ ThemeID=001: "ES書き方" → TypeID=002
├─ ThemeID=002: "就活の不安" → TypeID=001
└─ ThemeID=003: "企業情報" → TypeID=003

ペルソナ管理:
├─ PersonaID=015: 方法論重視型就活生
├─ PersonaID=032: 体験共感型就活生
└─ PersonaID=048: データ重視型就活生

テーマ×ペルソナ連携テーブル:
ThemeID=001 "ES書き方"
├─ PersonaID=015: 方法論重視型（推奨）
├─ PersonaID=028: スキル習得型
└─ PersonaID=041: 問題解決型
```

## 🔧 コンポーネント設計

### **1. リサーチプロンプト生成エンジン**
```
【役割】
TypeID + PersonaID + UserTitle → 最適化リサーチプロンプト生成

【入力】
- 投稿タイプID
- ペルソナID  
- ユーザー入力タイトル

【処理】
- タイプ×ペルソナに最適化されたリサーチプロンプト生成
- ペルソナの有益性要件を自動挿入
- テーマに関連する重要情報の収集指示

【出力】
- 最適化されたリサーチプロンプト

【独立性】
他のコンポーネントの状態に依存しない単独動作
```

### **2. フォーマッターシステム**
```
【役割】
リサーチ結果 + 確定ページ構成・テンプレート → 情報欠損ゼロの構造化分割

【入力】
- リサーチ結果（「ある程度」構造化済み）
- 投稿タイプID
- テーマID
- ペルソナID
- 確定したページ構成・テンプレート

【処理】
- 確定したページ構成・テンプレートに合わせた情報分割
- 情報の欠損を一切させない純粋な整理
- ページ別データ構造への変換

【出力】
- ページ別整理済みデータ（情報の塊として保持）

【重要制約】
※有益性の抽出・判断は一切行わない
※情報の加工・解釈は行わない
※純粋な構造化・分割のみ実行
```

### **3. コンテンツ生成システム**
```
【役割】
情報の塊 + 成功パターンの有益性 → テンプレート構造に合わせたコンテンツ昇華

【入力】
- ページ別整理済みデータ（情報の塊）
- 投稿タイプID
- テーマID
- ペルソナID
- 確定した成功パターンの有益性
- 確定テンプレート構造

【処理】
- 成功パターンの「有益性」を情報の塊から抽出・識別
- TypeID×ThemeID×PersonaIDの成功パターン表現ロジック適用
- 情報の塊をテンプレート構造に合わせてコンテンツに昇華

【出力】
- テンプレート完全対応コンテンツ
- キャプション
- ハッシュタグ

【重要機能】
※有益性抽出はこのコンポーネントの専任
※成功パターンの表現ロジック実装
※テンプレート項目への完全適合
※情報の塊からコンテンツへの昇華が核心機能
```

### **4. テンプレート選択システム**
```
【役割】
TypeID → 最適テンプレート確定

【入力】
- 投稿タイプID

【処理】
- 投稿タイプに最適なテンプレート選択
- レイアウト仕様の確定
- 構成パターンの確定

【出力】
- 確定テンプレート仕様
- レイアウト設定

【独立性】
ペルソナやコンテンツに依存しない単独選択
```

## 🔗 連携設計の美しさ

### **独立性の保証**
```
各コンポーネントが単独でテスト・改善・拡張可能
障害発生時の影響局所化
コンポーネント単位での性能最適化
```

### **連携の確実性**
```
IDベース連携により、設定ミス・連携エラーを防止
投稿タイプID + ペルソナID の組み合わせで全システム最適化
新しい組み合わせの追加が容易
```

### **品質の保証**
```
各コンポーネントが専門性に特化
役割分離による品質向上
成功パターンの確実な再現
```

## 📋 システム実装要件

### **データベース要件**
1. **投稿タイプマスタ**: TypeID, 名称, 特徴, 構成パターン
2. **ペルソナマスタ**: PersonaID, 名称, 特徴, 有益性パターン
3. **テーママスタ**: ThemeID, 名称, 対応TypeID
4. **テーマ×ペルソナ連携テーブル**: ThemeID, PersonaID, 推奨フラグ
5. **成功パターンライブラリ**: TypeID×PersonaID, 成功要因, 表現パターン

### **API設計要件**
1. **リサーチプロンプトAPI**: generateResearchPrompt(TypeID, PersonaID, Title)
2. **フォーマッターAPI**: formatResearchResult(ResearchData, TypeID, PersonaID)
3. **コンテンツ生成API**: generateContent(FormattedData, TypeID, PersonaID)
4. **テンプレート選択API**: selectTemplate(TypeID)

### **品質保証要件**
1. **情報欠損防止**: フォーマッター段階での情報完全保持
2. **有益性抽出精度**: ペルソナ×成功パターンマッチング精度90%以上
3. **テンプレート適合性**: 生成コンテンツの項目適合率100%
4. **連携整合性**: IDベース連携の設定ミス0%

## 🚀 拡張性設計

### **新投稿タイプ追加**
```
1. 新TypeID登録
2. 対応テンプレート追加
3. フォーマッターロジック追加
4. 既存システムへの影響なし
```

### **新ペルソナ追加**
```
1. 新PersonaID登録
2. 有益性パターン定義
3. 成功パターン登録
4. テーマとの連携設定
```

### **新テーマ追加**
```
1. 新ThemeID登録
2. 対応TypeID設定
3. 推奨ペルソナ設定
4. 即座に選択肢として利用可能
```

## ⚡ パフォーマンス要件

### **応答時間要件**
- リサーチプロンプト生成: 1秒以内
- フォーマッター処理: 2秒以内
- コンテンツ生成: 5秒以内
- テンプレート選択: 0.5秒以内

### **同時処理要件**
- 最大同時ユーザー数: 100ユーザー
- レスポンス劣化許容範囲: 10%以内

## 🔒 セキュリティ要件

### **データ保護**
- ユーザー入力データの暗号化
- 生成コンテンツの一時保存期間制限
- API アクセスの認証・認可

### **品質保護**
- 不適切コンテンツの自動検出
- 生成結果の品質チェック
- 異常パターンの検出・アラート

---

## 🎯 期待される成果

### **ユーザー価値**
- 直感的な3ステップ操作でプロ品質投稿生成
- 科学的根拠に基づく高エンゲージメント保証
- 完全カスタマイズ可能な柔軟性

### **システム価値**
- 各コンポーネントの独立最適化
- 障害耐性・拡張性の確保
- 保守・運用コストの最小化

### **ビジネス価値**
- Instagram投稿生成の新スタンダード確立
- 他プラットフォーム・ジャンルへの展開基盤
- 持続的競争優位性の獲得

---

**作成日**: 2025-07-19  
**版数**: 1.0  
**承認**: システム設計責任者  
**次回レビュー**: 統合分析完了後