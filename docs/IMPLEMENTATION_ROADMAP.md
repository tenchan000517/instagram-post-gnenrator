# 🚀 ナレッジベース生成システム実装ロードマップ

**作成日**: 2025-07-22  
**目的**: Phase 7設計思想に基づく実装計画の策定

---

## 🏗️ **Phase A: データ現状調査・ギャップ分析**

### **A1. 既存データの詳細分析と対応可能性調査** 🔴 HIGH
```
目的: 現在のデータでどこまで実現可能かを明確化

調査項目:
1. problemSolutionPairs.json (116ナレッジ)
   - 各ナレッジのページ構成・テンプレート構造の有無
   - ストーリー性・フロー情報の記録状況
   - ペルソナ-ナレッジ関係の詳細マッピング

2. pageStructureMatching.json vs 実際のpageStructures/
   - 66パターン定義 vs 5ファイルのギャップ詳細
   - 各ナレッジに適したページ構造の特定

3. ペルソナ-投稿タイプ関係の現状
   - 116ペルソナの投稿タイプ分類状況
   - ターゲット-ペルソナ関係の整合性

成果物: データ現状分析レポート・対応表
```

### **A2. 既存システムでは実現できない機能のギャップ分析** 🔴 HIGH
```
目的: 新規開発が必要な機能の特定と優先順位付け

調査対象:
1. UI層の対応不足
   - 現在の5ターゲット vs 必要な12ターゲット
   - 抽象的TypeID vs 具体的投稿タイプ

2. AI類似度検索機能
   - ユーザー入力 vs ナレッジ類似度計算
   - スコア付け・推奨機能の不在

3. ナレッジ構造保持システム
   - 現在のテンプレート固定化 vs 柔軟構造対応
   - ナレッジ固有フローの認識・活用機能

4. 投稿タイプフィルタリング機能
   - ペルソナの投稿タイプ適合判定
   - 動的フィルタリングシステム

成果物: 開発必要機能リスト・技術要件定義
```

---

## 🧹 **Phase B: データクリーンアップ・再構成**

### **B1. ペルソナ重複チェックと品質評価による整理** 🔴 HIGH
```
目的: 同一ターゲット内重複ペルソナの検出・統合

実行手順:
1. 投稿タイプ別ペルソナ品質評価基準の適用
   - キャリア悩み: 困りごと明確性 × 共感型ナレッジ適合度
   - スキルアップ: 困りごと明確性 × 教育型ナレッジ適合度
   - 業界情報: 困りごと明確性 × 情報型ナレッジ適合度
   - 効率アップ: 困りごと明確性 × 実用型ナレッジ適合度

2. 重複ペルソナの統合・削除判定
3. 品質スコア付けと優先順位決定

成果物: クリーンアップ済みペルソナDB・品質評価レポート
```

### **B2. 116ペルソナの12ターゲット再分類・紐づけ** 🔴 HIGH
```
目的: 4投稿タイプ×3ターゲットの新構造に対応

実行内容:
1. 投稿タイプ別ペルソナ分類
   - キャリア悩み解決型: ○○ペルソナ → 3ターゲットに分類
   - スキルアップガイド型: ○○ペルソナ → 3ターゲットに分類
   - 業界情報まとめ型: ○○ペルソナ → 3ターゲットに分類
   - 効率アップテクニック型: ○○ペルソナ → 3ターゲットに分類

2. 各ターゲットの特性定義・説明文作成
3. ペルソナ-ターゲット-投稿タイプの3者関係整合性確保

成果物: 新ターゲット定義・ペルソナマッピング表
```

### **B3. ナレッジのページ構成・テンプレート構造分析** 🔴 HIGH
```
目的: 各ナレッジが持つ固有構造の抽出・体系化

分析項目:
1. 各ナレッジのストーリーフロー分析
   - 感情の流れ・説得構造の特定
   - AIDMA・起承転結等のパターン識別
   - 最適ページ数・構成の決定

2. テンプレート構造の類型化
   - 共感×5→行動型
   - 概要→手順×4型
   - その他パターンの発見・分類

3. ナレッジ-最適構造の対応表作成

成果物: ナレッジ構造分析DB・テンプレート類型一覧
```

---

## 🔧 **Phase C: システム実装・機能開発**

### **C1. KnowledgeBaseSelectorの全面改修** 🟡 MEDIUM
```
目的: 新UI設計（4投稿タイプ×12ターゲット）の実装

実装内容:
1. 投稿タイプ選択UI (具体的な4タイプ)
2. ターゲット選択UI (選択投稿タイプに応じた3ターゲット表示)
3. 選択状態管理の改良
4. フィルタリング機能の実装

技術要件: React/TypeScript、状態管理最適化
```

### **C2. AI類似度検索ロジックの実装** 🟡 MEDIUM
```
目的: ユーザー入力とナレッジの類似度計算・推奨機能

実装内容:
1. テキスト類似度計算アルゴリズム
2. スコア付けロジック
3. 推奨ナレッジの優先順位表示
4. ユーザー最終選択インターフェース

技術要件: NLP処理、ベクトル類似度計算、Gemini AI活用
```

### **C3. プロンプト改善・最適化** 🟡 MEDIUM
```
目的: ナレッジ構造尊重・事実厳守プロンプトの実装

改善ポイント:
1. ナレッジの構造保持指示
2. 事実以外の情報追加厳禁指示
3. ユーザー意図に応じた表現調整指示
4. 投稿タイプ特性に応じたプロンプト最適化

成果物: 投稿タイプ別最適化プロンプトテンプレート
```

### **C4. 困った→解決生成フローのシステム実装** 🟡 MEDIUM
```
目的: 新フローの完全なシステム化

実装パス:
1. 投稿タイプ選択 → ターゲット選択
2. ペルソナ自動フィルタリング → ナレッジ自動フィルタリング
3. ユーザー入力 → AI類似度検索 → ナレッジ選択
4. 投稿タイプペルソナフィルタリング → 最終確定
5. ナレッジ構造 → プロンプト生成 → コンテンツ生成

技術要件: フロー管理、状態遷移、エラーハンドリング
```

### **C5. ナレッジ自体からページ構成決定システム** 🟡 MEDIUM
```
目的: 固定テンプレートからナレッジ固有構造への移行

実装内容:
1. ナレッジ構造分析エンジン
2. 最適ページ構成の動的決定
3. テンプレート構造の柔軟生成
4. ナレッジフロー保持機能

技術要件: 動的テンプレート生成、構造分析アルゴリズム
```

---

## 🔍 **Phase D: 品質保証・テスト**

### **D1. データ整合性チェック** 🟢 LOW
```
目的: 投稿タイプフィルタリング用データの整合性確保

チェック項目:
1. ペルソナ-ナレッジ-投稿タイプの3者関係
2. ターゲット内ペルソナ重複の最終確認
3. ナレッジ構造データの完整性
4. フィルタリング機能の動作確認

成果物: 品質保証レポート・データ検証済み証明
```

### **D2. テスト環境構築と品質検証フレームワーク** 🟢 LOW
```
目的: 新フローの動作確認・品質検証

構築内容:
1. 各段階でのテストケース作成
2. エンドツーエンドテスト環境
3. ナレッジ構造保持の検証方法
4. 生成コンテンツ品質評価指標

成果物: テスト環境・品質評価基準・テストレポート
```

---

## 📋 **実装優先順位**

### **🔴 最優先 (Phase A + B1-3)**
1. データ現状調査・ギャップ分析
2. ペルソナクリーンアップ・再分類
3. ナレッジ構造分析

### **🟡 次優先 (Phase C)**
4. UI改修・AI類似度検索
5. プロンプト改善・フロー実装
6. 動的ページ構成システム

### **🟢 最終段階 (Phase D)**
7. 品質保証・テスト環境構築

---

## 🎯 **成功指標**

1. **データ完整性**: ペルソナ重複0件、116ペルソナ→12ターゲット完全マッピング
2. **システム品質**: UI選択可能パターンの実行成功率100%
3. **コンテンツ品質**: 事実以外情報0件、ナレッジ構造保持率100%
4. **ユーザー体験**: 類似度検索精度向上、選択迷い時間短縮

---

**最終更新**: 2025-07-22  
**ステータス**: 実装計画確定  
**次ステップ**: Phase A1 データ現状調査開始