# ペルソナ統合3段階システム設計ドキュメント

## 📋 概要

本ドキュメントは、4つの分析フレームワークを3段階システム（リサーチ→フォーマット→コンテンツ生成）で活用し、特にペルソナ分析の価値を最大化するための設計を記録したものです。

**作成日**: 2025-07-19  
**ステータス**: ペルソナ統合設計完了  
**前提**: 投稿タイプシステム設計 + 3段階システム設計の統合  

## 🚨 設計の重要な修正点

### 当初の間違ったアプローチ
```
❌ リサーチプロンプト = 投稿タイプ特化のみ
   ↓
   ペルソナ分析結果が活用されない
   ペルソナの具体的悩み・言葉遣い・関心事が反映されない
```

### 正しい3段階アプローチ
```
✅ ①リサーチ段階: ペルソナ分析 + 投稿内容分析 → 対象特化リサーチ
   ②フォーマット段階: ページ構成分析 + 有益性分析 → 構造化
   ③コンテンツ生成段階: 既存システムで最終生成
```

## 🎯 3段階システムでのペルソナ活用設計

### ①リサーチ段階：ペルソナ中心設計

#### 入力情報の構成
```typescript
interface ResearchStageInput {
  // ペルソナ情報（最重要）
  selectedPersona: string
  personaAnalysis: {
    realConcerns: string[]      // 実際の悩み
    language: string[]          // 使用する言葉遣い
    interests: string[]         // 関心事
    situations: string[]        // 置かれている状況
  }
  
  // 投稿内容情報（ペルソナ補強用）
  contentAnalysis: {
    expressionPatterns: string[]  // 表現パターン
    challengeLevel: string        // 課題レベル
    specificityLevel: string      // 具体性レベル
  }
  
  // ユーザー入力
  userTheme: string
}
```

#### リサーチプロンプトの設計原則
- **投稿タイプに関係なく、ペルソナ特化で情報収集**
- **ペルソナの実際の悩み・言葉遣い・関心事を最優先**
- **投稿形式は一切指定せず、純粋な情報収集に特化**

#### リサーチプロンプトの構成例
```typescript
const generateResearchPrompt = (input: ResearchStageInput) => `
【対象ペルソナ】${input.selectedPersona}

【ペルソナの実際の状況】
- 具体的な悩み: ${input.personaAnalysis.realConcerns.join(', ')}
- 使用する言葉: ${input.personaAnalysis.language.join(', ')}
- 関心のある領域: ${input.personaAnalysis.interests.join(', ')}
- 置かれている状況: ${input.personaAnalysis.situations.join(', ')}

【リサーチテーマ】${input.userTheme}

【リサーチ指示】
以下の観点でこのペルソナに特化した情報を収集してください：

1. このペルソナが「${input.userTheme}」について実際に抱えている悩み・課題
   - 具体的な状況やエピソード
   - 感じている感情や困難
   - 周囲との関係での悩み

2. このペルソナに適した成功事例・解決策
   - 同じ立場の人の体験談
   - 実践可能で現実的な方法
   - 段階的なアプローチ

3. このペルソナが理解しやすい表現・言葉遣い
   - ${input.personaAnalysis.language.join(', ')}を活用
   - 親しみやすく共感できる表現
   - 専門用語は避けて分かりやすく

4. このペルソナの関心を引く関連情報
   - ${input.personaAnalysis.interests.join(', ')}との関連性
   - 将来への影響や可能性
   - 同世代・同立場の人への価値

※投稿形式は一切指定せず、純粋にこのペルソナに最適化された情報収集に特化してください
※抽象的な一般論ではなく、このペルソナの具体的な状況に根ざした情報を重視してください
`
```

#### 期待される出力
- **ペルソナの実際の言葉遣いで表現された悩み・課題**
- **同じ立場の人の具体的体験談・成功事例**
- **ペルソナが理解しやすい表現での解決策**
- **ペルソナの関心に合致した関連情報**

### ②フォーマット段階：投稿タイプ特化設計

#### 入力情報の構成
```typescript
interface FormatStageInput {
  researchResult: string        // ①の出力（ペルソナ特化情報）
  selectedPostType: PostType    // 選択された投稿タイプ
  pageStructureAnalysis: {      // ページ構成分析結果
    totalPages: number
    pageFlow: string[]
    psychologicalDesign: string
  }
  beneficialValueAnalysis: {    // 有益性分析結果
    valueElements: string[]
    informationDensity: string
    tone: string
  }
}
```

#### フォーマットプロンプトの設計原則
- **ペルソナ特化リサーチ結果を最大限活用**
- **投稿タイプの構成要件に適合させる**
- **ペルソナの言葉遣いや関心事を保持**
- **コンテンツ生成はせず、構造化された素材として整理**

#### フォーマットプロンプトの構成例
```typescript
const generateFormatPrompt = (input: FormatStageInput) => `
【ペルソナ特化リサーチ結果】
${input.researchResult}

【投稿タイプ】${input.selectedPostType}

【構成要件】
- 総ページ数: ${input.pageStructureAnalysis.totalPages}枚
- ページフロー: ${input.pageStructureAnalysis.pageFlow.join(' → ')}
- 心理設計: ${input.pageStructureAnalysis.psychologicalDesign}

【価値要件】
- 価値要素: ${input.beneficialValueAnalysis.valueElements.join(', ')}
- 情報密度: ${input.beneficialValueAnalysis.informationDensity}
- トーン: ${input.beneficialValueAnalysis.tone}

【フォーマット指示】
上記のペルソナ特化リサーチ結果を、指定された投稿タイプの構成でフォーマットしてください：

${getPostTypeSpecificFormatRules(input.selectedPostType)}

※リサーチ結果の内容を活かし、ペルソナの言葉遣いや関心事を保持してください
※コンテンツ生成はせず、構造化された素材として整理してください
`
```

#### 投稿タイプ別フォーマットルール

##### 共感型ファネル構成
```typescript
case 'empathy-funnel':
  return `
【共感型ファネル構成】
1. 問題提起ページ（2-6枚）: リサーチ結果の具体的悩みを段階的に配置
   - ペルソナが実際に体験する具体的シーン
   - ペルソナの感情表現と言葉遣いを反映
   - 反問形式でペルソナの心の声を表現

2. 転換点ページ（1枚）: 感情的共鳴の頂点を設計
   - ペルソナの内面的な気づきや理解
   - 解決への期待感を自然に醸成

3. 解決策ページ（1-2枚）: 具体的サポート内容を提示
   - ペルソナの状況に適した解決策
   - ペルソナが理解しやすい表現で説明

各ページにペルソナの感情表現と言葉遣いを反映させ、段階的共感醸成を実現してください
  `
```

##### 教育型コンテンツ構成
```typescript
case 'educational-content':
  return `
【教育型コンテンツ構成】
1. 問題提起ページ（1-2枚）: ペルソナの不安を明確化
   - ペルソナが抱える具体的な不安や課題
   - ペルソナが使用する自然な表現で問題を言語化

2. Point構造ページ（5-8枚）: リサーチ結果を教育的に整理
   - ペルソナの理解レベルに合わせた説明
   - ペルソナの関心事と関連付けた実践的内容
   - ペルソナの言葉遣いで行動指針を表現

3. 行動促進ページ（1枚）: 具体的な次のステップを提示
   - ペルソナの状況で実践可能な行動
   - ペルソナが親しみやすいコミュニケーション

ペルソナの関心事と学習レベルに合わせた内容配置をしてください
  `
```

##### 要約→証明→行動促進型
```typescript
case 'proof-driven':
  return `
【要約→証明→行動促進型構成】
1. 手順要約ページ（1枚）: ペルソナの理解レベルに合わせた手順整理
   - ペルソナが理解しやすい言葉での手順説明

2. 実績証明ページ（1枚）: ペルソナと同じ立場の人の成功事例
   - ペルソナが共感できる体験談
   - ペルソナの状況に近い成果例

3. オファー提示ページ（1枚）: ペルソナの関心に合わせた価値提案
   - ペルソナが魅力を感じる特典内容
   - ペルソナが行動しやすい参加方法

ペルソナの立場と関心事を最大限反映させてください
  `
```

#### 期待される出力
- **投稿タイプの構成に適合した構造化素材**
- **ペルソナの言葉遣いと関心事を保持した内容**
- **各ページの役割と心理設計が明確な素材**
- **既存システムで生成可能な形式の構造化データ**

### ③コンテンツ生成段階：既存システム活用

#### 処理の概要
```typescript
// ②の出力を既存システムの入力形式にマッピング
const mapToExistingSystem = (formatResult: string, postType: PostType) => {
  // 既存のcontentGeneratorService.generateHighQualityContent()に渡す
  return formatResult  // 構造化された素材をそのまま入力
}
```

#### 既存システムとの連携
- **フォーマット結果を既存システムの入力として利用**
- **投稿タイプ別のテンプレート選択ロジック適用**
- **最終的な投稿生成とブランドガイドライン適用**

## 🔄 統合フロー全体像

### 正しい統合フロー
```
ペルソナ選択 → 投稿タイプ推奨 → テーマ入力
          ↓
①リサーチ段階: ペルソナ分析 + 投稿内容分析 → ペルソナ特化情報収集
          ↓  
②フォーマット段階: ページ構成分析 + 有益性分析 → 投稿タイプ構造化
          ↓
③コンテンツ生成段階: 既存システム → 最終投稿生成
```

### 4つの分析結果の活用マッピング

#### ①リサーチ段階での活用
- **ペルソナ分析**: 対象者の具体的悩み・関心事・言葉遣い
- **投稿内容分析**: 実際の投稿から抽出した表現パターン・課題レベル

#### ②フォーマット段階での活用  
- **ページ構成分析**: 投稿の枚数・フロー・心理設計
- **有益性分析**: 価値要素・情報密度・提供方法

#### ③コンテンツ生成段階での活用
- **既存システムのテンプレート・ブランドガイドライン適用**

## 📈 期待される効果

### Before（投稿タイプ特化のみ）vs After（ペルソナ統合3段階）

#### ❌ Before: 投稿タイプ特化の問題
```
投稿タイプのみでリサーチ → 汎用的な情報 → ペルソナから乖離したコンテンツ
```

#### ✅ After: ペルソナ統合3段階の成功
```
① ペルソナ特化リサーチ → ② 投稿タイプ構造化 → ③ 高品質生成
→ ペルソナに完全適合した実用的コンテンツ
```

### 実現される価値

#### 真のペルソナ適合コンテンツ
- **ペルソナの実際の悩み・言葉遣いを反映**
- **ペルソナの関心事と学習レベルに最適化**
- **ペルソナが理解しやすい表現での情報提供**

#### 投稿タイプの構成価値
- **段階的心理誘導の確実な実現**
- **価値要素の適切な配置**
- **Instagram投稿に最適化された構造**

#### システム全体の統合価値
- **4つの分析結果の完全活用**
- **既存システムとのシームレスな連携**
- **段階的な品質向上による高精度生成**

## 🚀 実装における重要ポイント

### 各段階の独立性保持
- **①リサーチ段階**: ペルソナ特化情報収集に特化
- **②フォーマット段階**: 投稿タイプ構造化に特化  
- **③コンテンツ生成段階**: 既存システムの活用

### ペルソナ価値の一貫した保持
- **①→②**: ペルソナの言葉遣い・関心事を保持してフォーマット**
- **②→③**: 構造化された素材を既存システムで生成**

### 投稿タイプ別の最適化
- **各投稿タイプの心理設計と構成要件を確実に実現**
- **ペルソナとの完璧な適合**

## 🎯 次のステップ

1. **①リサーチプロンプト精密化**
   - ペルソナ×テーマの組み合わせパターン設計
   - 実際の投稿要素抽出ルールの体系化

2. **②フォーマットプロンプト完成**
   - 投稿タイプ別の構造化ルール確立
   - ページ構成×有益性の組み合わせパターン設計

3. **③既存システム連携仕様**
   - フォーマット結果の既存入力形式へのマッピング
   - シームレスな連携フローの実装

---

**この設計により、ペルソナ分析の価値を最大化しながら、投稿タイプ別の最適構成を実現する革新的なInstagram投稿生成システムが構築される。**