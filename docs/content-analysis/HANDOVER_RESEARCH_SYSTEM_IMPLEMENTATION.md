# 🔄 リサーチシステム実装 - 引き継ぎドキュメント

**引き継ぎ日時**: 2025-07-21  
**セッション内容**: 統合リサーチシステム設計完了・プロンプト生成AI実装仕様策定  
**コンテキスト使用率**: 高 - 継続実装のため引き継ぎ実施  
**完成度**: 設計完了・実装準備完了

---

## 📚 必読ドキュメント（優先順）

### **1. 最重要 - 完成した統合設計書**
```
/docs/content-analysis/INTEGRATED_RESEARCH_SYSTEM_DESIGN.md
```
- **内容**: 8ステップ完全システム設計・プロンプト生成AI統合
- **重要性**: 今回のセッションで完成した最終成果物
- **含まれる要素**: 投稿タイプ×ターゲット理論、コンテンツID中心設計、AI負荷軽減

### **2. プロンプト生成AI実装仕様**
```
/docs/content-analysis/PROMPT_GENERATION_AI_INPUT_FORMAT.md
```
- **内容**: Step 7のプロンプト生成AI入力フォーマット完全設計
- **重要性**: 実装に直結する技術仕様
- **含まれる要素**: JSON構造、AI指示プロンプト、実装コード例

### **3. システム要件分析**
```
/docs/content-analysis/THEME_DB_REQUIREMENTS_ANALYSIS.md
/docs/content-analysis/SYSTEM_CONCERNS_MEMO.md
```
- **内容**: テーマDB項目要件・システム課題整理
- **重要性**: 実装時の注意点・考慮事項

### **4. 投稿タイプ×ターゲット対応表**
```
/docs/content-analysis/SYSTEM_TYPE_TARGET_MAPPING.md
```
- **内容**: 確定した4投稿タイプとターゲット体系
- **重要性**: システムのUI設計・データ構造基盤

### **5. 実証テスト結果**
```
/docs/content-analysis/RESEARCH_PROMPT_GENERATION_TEST.md
```
- **内容**: contents-075を使った実際のプロンプト生成テスト
- **重要性**: システムの動作確認・品質検証

---

## 🎯 完成したシステム設計

### **8ステップ統合システムフロー**
1. **投稿タイプ選択**: 4つの確定タイプから選択
2. **ターゲット選択**: タイプに対応するターゲットから選択
3. **検索対象絞り込み**: ペルソナグループ→テーマ群絞り込み
4. **投稿内容入力**: ユーザーの具体的要求
5. **AI最適テーマ選択**: テーマレベルでの類似度×評価選択
6. **4軸分析結果確定**: コンテンツIDの完全な分析データ取得
7. **リサーチプロンプト生成AI呼び出し**: 4軸生データ→実用プロンプト変換
8. **後続システム連携**: フォーマッター→コンテンツ生成→最終表示

### **核心設計思想**
- **コンテンツID中心**: 1つのコンテンツID = 4軸の完全セット
- **AI負荷軽減**: 段階的絞り込みによる処理最適化
- **完全自動化**: 人間解釈作業をAI化で排除

---

## 🏗️ 実装準備完了事項

### **1. データ構造設計完了**
- **4投稿タイプ**: キャリア悩み解決・スキルアップガイド・業界企業情報・効率アップテクニック
- **ターゲット体系**: 各タイプに3つずつのターゲット設定済み
- **4軸分析データ**: 既存バッチ分析結果をそのまま活用可能

### **2. プロンプト生成AI仕様完了**
```javascript
// 実装可能なAI呼び出し構造
const generateResearchPrompt = async (inputData) => {
  const prompt = `
あなたはInstagram投稿用のリサーチプロンプト生成の専門AIです。

【ユーザー要求】
- 作りたい投稿: ${inputData.userRequest}
- 投稿タイプ: ${inputData.selectedType}
- ターゲット: ${inputData.selectedTarget}

【成功コンテンツ基準】
- ペルソナ分析: ${inputData.personaAnalysis}
- テーマ分析: ${inputData.themeAnalysis}  
- 表現方法分析: ${inputData.expressionAnalysis}
- 有益性分析: ${inputData.benefitAnalysis}

成功コンテンツの特徴を再現しながら、ユーザー要求に最適化したリサーチプロンプトを生成してください。
  `;
  
  return await callAI(prompt);
};
```

### **3. テスト実証完了**
- **テストケース**: 「就活でAIを活用して効率アップ！」
- **選択コンテンツ**: contents-075
- **生成結果**: 高品質なリサーチプロンプト生成を確認

---

## 📊 必要なデータベース構造

### **TypeID-ターゲット対応テーブル**
```sql
CREATE TABLE type_target_mapping (
  type_id VARCHAR(3),      -- '001', '002', '003', '004' 
  target_name TEXT,        -- '就活に不安を感じている学生' etc
  display_name TEXT,       -- UI表示用名称
  persona_group_id TEXT    -- 対応するペルソナグループ
);
```

### **ペルソナ-テーマ関連度テーブル**
```sql  
CREATE TABLE persona_theme_relevance (
  persona_id TEXT,
  theme_id TEXT,
  content_id TEXT,
  relevance_score FLOAT,
  engagement_score FLOAT
);
```

### **コンテンツ統合データ**
```sql
CREATE TABLE content_analysis (
  content_id TEXT PRIMARY KEY,
  persona_analysis JSON,
  theme_analysis JSON,
  expression_analysis JSON,
  benefit_analysis JSON,
  engagement_score FLOAT
);
```

---

## 🚀 実装フェーズの優先順位

### **Phase 1: 基盤実装（最優先）**
1. **投稿タイプ×ターゲット選択UI**: 4×3のマトリクス選択
2. **検索対象絞り込みロジック**: ペルソナグループ→テーマ群抽出
3. **4軸分析データ読み込み**: 既存バッチファイルのJSON化

### **Phase 2: AI統合（高優先）**
1. **テーマ選択AI**: 類似度判定×評価スコア選択
2. **プロンプト生成AI**: 4軸データ→リサーチプロンプト変換
3. **エンドツーエンドテスト**: 全8ステップの動作確認

### **Phase 3: 最適化（中優先）**
1. **類似度判定精度向上**: テーママッチングアルゴリズム調整
2. **エンゲージメント指標更新**: 評価スコア自動更新機能
3. **UIユーザビリティ向上**: 選択フローの最適化

---

## 🔍 重要な実装注意点

### **1. 4軸データの活用方法**
- **既存バッチ分析結果をそのまま使用**: 統合ID（P001等）は不要
- **JSON構造化**: 各コンテンツの4軸データをAPI送信可能な形式に
- **品質保証**: contents-075レベルの詳細データが必要

### **2. AI類似度判定の課題**
- **抽象性問題**: 「効率化技術」vs「PCショートカット」の具体性ギャップ
- **母数の影響**: 100件で十分な類似度判定が可能かの検証必要
- **対策**: テーマ分析項目の追加検討または運用テストでの精度確認

### **3. システム課題（解決済み）**
- **4軸分析データの具体性問題**: プロンプト生成AIで解決
- **人間解釈依存**: 完全自動化システムで解決
- **処理負荷**: 段階的絞り込みで大幅軽減

---

## 📝 未完了事項（次フェーズ）

### **実装待ち項目**
1. **ペルソナグルーピング**: P001-P010を4ターゲットカテゴリに振り分け
2. **ページ構成統合**: 同様構成のテンプレート統合分析
3. **エンゲージメント指標**: フォロワー×いいね数の具体的算出方法

### **将来拡張項目**
1. **新コンテンツ追加**: 分析→DB登録の自動化
2. **A/Bテスト機能**: 複数プロンプトでの効果比較
3. **学習機能**: ユーザー選択パターンからの精度向上

---

## 🎯 成功判定基準

### **Phase 1完了基準**
- ✅ 8ステップフローの技術的実装完了
- ✅ テストケースでの正常動作確認
- ✅ contents-075レベルの品質プロンプト生成

### **システム成功基準**
- ✅ ユーザー入力→リサーチプロンプト生成の完全自動化
- ✅ 成功コンテンツパターンの再現性確保
- ✅ AI処理負荷の軽減と高速レスポンス

---

## 🚨 緊急時対応

### **設計に関する疑問**
1. `INTEGRATED_RESEARCH_SYSTEM_DESIGN.md`の該当箇所を確認
2. contents-075テスト結果と照らし合わせて判断
3. 4軸分析の基本思想（コンテンツID中心）に立ち返る

### **実装で迷った場合**
1. プロンプト生成AI仕様を最優先で実装
2. 既存4軸バッチデータをそのまま活用
3. ユーザー体験より処理効率を重視

---

**引き継ぎ完了**: この文書を読んだ次の担当者は、上記の必読ドキュメントを確認後、Phase 1の基盤実装から開始してください。

**最重要**: リサーチシステムの設計は完了していますが、実装とテストが必要です。特にプロンプト生成AIの統合が成功の鍵となります。