# テンプレート配置ルールマスタードキュメント

## 基本原則

### 1. 情報欠損の完全回避
- **既存情報の完全保持**: detailedContentの全ての情報価値を一切落とさず、欠損させない
- **段階的移行**: 元の構造から新しいテンプレート構造への情報を段階的に移行
- **検証必須**: 移行前後で情報の漏れがないことを必ず確認

### 2. 文体統一原則
- **ですます調の徹底**: 全てのコンテンツはですます調で統一
- **丁寧語の維持**: 読者に対する敬意を保った文体
- **一貫性の確保**: 同一ナレッジ内での文体ブレを防止

### 3. 情報の適切な配置
- **重要情報の優先配置**: 最も伝えたい内容を読者の視線が最初に向かう位置に配置できるテンプレートを選ぶ
- **読者導線の最適化**: 情報の重要度に応じた適切な配置順序ができるテンプレートを選ぶ

## オーバーライド機能の理解と活用

### オーバーライドの具体的仕組み（K118参考例）
- **templateOverridesフィールド使用**: 特定ページで異なるテンプレートを指定
- **実装例**:
  ```json
  "templateOverrides": {
    "2": "ng_good_comparison",
    "3": "category_explanation", 
    "4": "category_explanation"
  }
  ```
- **ページ単位での個別指定**: ページ2でng_good_comparison、ページ3-4でcategory_explanationを使用
- **基本構造との併用**: pageStructurePatternの基本構造を維持しつつ特定ページのみカスタマイズ

### ⚠️ 重要な制約事項・作業分離
- **Phase 2-1での改変対象**: pageStructurePatternフィールドの配置のみ
- **Phase 2-2での改変対象**: detailedContentの構造改変（情報欠損防止・テンプレート最適配置）
- **構造改変の目的**: テンプレートの意図通りに情報を配置し、情報価値を最大化する
- **改変範囲の限定**: detailedContentのみが対象、その他フィールドは改変しない

### 🚨 廃止テンプレート使用禁止
以下のテンプレートは廃止されており、使用禁止です：

#### 廃止テンプレート一覧
- **ng_good_comparison**: NG/GOOD比較用（現在はunified-template-05-comparisonで対応）
- **category_explanation**: カテゴリ説明用（現在は適切なUnifiedテンプレートで対応）
- **vision_strength_matrix**: ビジョン×強みマトリックス用（現在は適切なUnifiedテンプレートで対応）

#### 発見箇所と対応状況
- **K059.json** (Type001): ng_good_comparison → ✅修正済み（templateOverrides削除）
- **K117.json** (Type002): ng_good_comparison, category_explanation, vision_strength_matrix → ❌要修正
- **K118.json** (Type002): ng_good_comparison, category_explanation → ❌要修正

#### 対応方法
1. **templateOverridesを削除**
2. **pageStructurePatternに適切なUnifiedテンプレートを設定**
3. **内容に応じたテンプレート選択**:
   - NG/GOOD比較 → `unified-template-05-comparison`
   - カテゴリ説明 → `unified-template-08-section-blocks`
   - マトリックス → `unified-template-04-item-grid`

## Unifiedテンプレート別配置指針

### unified-template-01-simple-intro
- **適用対象**: シンプルな導入コンテンツ
- **配置重点**: タイトルと説明文の明確な配置
- **注意点**: 画像とテキストのバランス

### unified-template-02-dual-section  
- **適用対象**: 2つの要素を対比・並列表示するコンテンツ
- **配置重点**: 上下セクションの論理的関係性
- **注意点**: セクション間の情報格差の回避

### unified-template-03-ranking-display
- **適用対象**: ランキング・順位付けコンテンツ  
- **配置重点**: 順位の根拠と評価基準の明示
- **注意点**: ランキング以外の情報の適切な配置

### unified-template-04-item-grid
- **適用対象**: 複数アイテムの並列紹介
- **配置重点**: 各アイテムの情報密度の均等化
- **注意点**: グリッド内での情報量のバランス

### unified-template-05-comparison
- **適用対象**: 比較・対比型コンテンツ
- **配置重点**: 比較軸の明確化と公平な情報配置
- **注意点**: 左右セクションの情報量バランス

### unified-template-06-company-detail
- **適用対象**: 企業・組織の詳細紹介
- **配置重点**: 企業の特徴的な情報の効果的配置
- **注意点**: 定量的情報の正確な表示

### unified-template-07-item-list
- **適用対象**: リスト形式のコンテンツ
- **配置重点**: リスト項目の論理的順序
- **注意点**: 各項目の情報密度の統一

### unified-template-08-section-blocks
- **適用対象**: セクション別に分けた情報提供
- **配置重点**: セクション間の関連性と独立性のバランス
- **注意点**: セクション内情報の完結性

### unified-template-09-dynamic-boxes
- **適用対象**: 動的・柔軟な情報ボックス
- **配置重点**: ボックス内情報の自己完結性
- **注意点**: ボックス間の情報格差の管理

### unified-template-10-image-point
- **適用対象**: 画像中心のポイント説明
- **配置重点**: 画像とテキストの相互補完関係
- **注意点**: 重要ポイントの視覚的強調

## 投稿タイプ別適用ルール

### Type001 (感情共感型)
- **配置重点**: 感情的共感の段階的構築
- **注意事項**: 共感体験の自然な流れを優先
- **⚠️ 重要**: キャラクターとの感情的つながりが核心。情報量より感情共感の質を重視
- **テンプレート選択**: `unified-template-01-simple-intro`が基本適合（感情共感重視設計）
- **画像配置必須ルール**:
  - 複数キャラクター使用（同一キャラクター連続使用禁止）
  - 感情の流れに応じた表情選択（困りごと→worry、解決→通常表情）
  - 8ページ構成では最低4-5種類のキャラクター＋表情バリエーション必要

### Type002 (実践習得型)  
- **配置重点**: 実践ステップの論理的順序
- **注意事項**: アクション可能な情報の明確化

### Type003 （ランキング・Tier表など情報型）
- **既存設定の維持**: 現在の配置を基本的に保持
- **必要時のみ調整**: 重大な問題がある場合のみ変更検討

### Type004 (ツールなど並列紹介型)
- **配置重点**: ツールなどを順序に依存せず並列で紹介・解説する
- **注意事項**: データの正確性と完全性の確保

## 品質保証チェックリスト

### 配置前チェック
- [ ] 元のdetailedContentの全情報を把握
- [ ] 適切なUnifiedテンプレートを選択
- [ ] オーバーライドの必要性を評価

### 配置中チェック  
- [ ] 重要情報の適切な位置への配置
- [ ] ですます調の文体統一
- [ ] テンプレート構造との適合性

### 配置後チェック
- [ ] 情報の欠損・重複がないことを確認
- [ ] 読者導線の最適性を検証
- [ ] 同一タイプ内での一貫性を確認

## 画像使用ガイドライン

### 使用可能画像リソース

#### AIツール関連画像 (`/public/imag/ai/`)
- Adobe_Firefly_Logo.png, ChatGPT-Logo.png, claude-ai-icon.png, copilot.png, gamma.png, Google-Gemini-1.png, mymind.png, Napkin-ai.png, NotebookLM_logo.png, perplexity.png
- **用途**: Type004のAIツール比較・紹介コンテンツ

#### 企業関連画像 (`/public/imag/company/`)  
- accenture.png, baincompany.png, bcg.png, canon.png, goldmansachs.png, google.png, honda.png, keyence.png, mckinsey.png, meta.png, mitsubishisyouji.png, mitsuibussan.png, nttdata.png, nufg.png, rakuten.png, softbank.png, sony.png, sumitomosyouji.png, takeda.png, tokiomarine.png
- **用途**: Type003の企業紹介コンテンツ

#### キャラクター画像 (`/public/`)
- **通常表情**: iida.png, kikuyo.png, king.png, misaki.png, ten.png（基本的に笑顔）
- **困り顔**: iida_worry.png, kikuyo_worry.png, king_worry.png, misaki_worry.png, ten_worry.png
- **仕事関連**: misaki_work.png（楽しそうに仕事）, misaki_busy.png（忙しそうに仕事）
- **学習・状態**: misaki_study.png（勉強中）, iida_fighting.png（モチベーション高）, iida_sleepy.png（眠そう）, iida_sorry.png（謝罪）
- **ポイント説明**: kikuyo_point.png（女性が重要ポイントを教えてくれてるポーズ）, king_point.png（男性が重要ポイントを教えてくれてるポーズ）
- **チームワーク**: team_work.png（チームワーク・会議イラスト）
- **用途**: Type001の感情共感コンテンツ
- **選択基準**: ターゲットの性別・内容に応じて適切なキャラクターを選択　また別途表情や違うバージョンのキャラクターが必要な場合はそれを明記する　※無理に今のキャラクターだけで全てを表現しようとする必要はありません

#### ⚠️ 感情表現の適切なレベル
- **基本原則**: 不必要に感情の抑揚を作りすぎない
- **適切な範囲**: 悩み（worry）→ 通常（笑顔）程度の自然な感情変化
- **避けるべき**: 握りこぶし、過度に前向きな表現は引かれる可能性がある
- **推奨**: 最後のページで笑顔（プレーン画像）にする程度が適切

### 画像使用ルール
1. **同一画像の連続使用禁止**: メインコンテンツで同じ画像を連続使用しない
2. **バランス考慮**: 同ページ内で画像ありとなしが混在するのは避ける
3. **テキスト量との調整**: テキスト量が少ないページは画像追加を検討
4. **オプショナル要素への配慮**: シンプルテンプレートでも画像なしはバランスが悪い

## 作業フロー

### Phase 2-1: pageStructurePattern配置フロー
1. **既存パターンの確認**: 現在設定されているpageStructurePatternを確認
2. **⚠️ Unified既存判定**: 既にunified-template-系が設定されている場合はテンプレート変更不要
3. **detailedContent構造適合性検証**: 既存・新規問わず、選択テンプレートで情報欠損なく表示可能かを検証
4. **Unifiedテンプレート選択**: 非Unified系のみ10種類から最適なテンプレートを選択
5. **パターン配置**: 選択したUnifiedテンプレートをpageStructurePatternフィールドに設定
6. **【必須】修正エビデンス記録**: 構造適合性検証結果を含む修正内容を記録（構造改変不要の場合も「修正不要」として必ず記載）
7. **進捗報告書更新**: エビデンス記載完了後に進捗報告書を更新

### ⚠️ 重要な実装フィードバック（2025-07-29）
#### Type001（感情共感型）の特別ルール
1. **ページ分割の推奨**: 複数項目が1ページに詰め込まれている場合、感情共感を深めるため各項目を個別ページに分割
   - 例：K007.json - 5つの特徴を2→6ページに分割
   - 例：K008.json - 4つの悩みを4→8ページに分割
   - **⚠️ 重要**: 分割時は元の情報を一切欠損させないこと。全ての説明文、詳細情報を適切に各ページに配分
   
2. **画像設定の正しい形式**: 
   - 正：`"imageSrc": "/misaki.png"`
   - 誤：`"imageFile": "misaki.png"`
   
3. **セクション統一ルール**: 
   - introduction（page1のみ）
   - mainContent（page2以降すべて統一）
   - summaryは使用せず、最終ページもmainContent
   
4. **構造の簡潔化**: 
   - ネストした複雑なcontent構造は避ける
   - シンプルなtitle/content/imageSrc構造に統一
   - **注意**: 簡潔化は構造のみ。コンテンツ内容は全て保持すること
   
5. **特別許可事項**: 
   - Type001に限り、Phase 2-1でも情報価値向上のためdetailedContent構造改変を実施可能
   - ただし、pageCountの変更も忘れずに実施すること
   - **原則**: 情報価値の向上のみが目的。情報の削除や省略は厳禁

6. **文体・表現の統一ルール**:
   - **固有名詞の排除**: 「元大手人事部」「ぴよこ」等の固有名詞・キャラクター名は使用しない
   - **口調の統一**: ですます調 + 落ち着いた優しい大人の口調
   - **絵文字の排除**: ✨、◎、！等の絵文字は使用しない
   - **例**: 
     - 誤：「ぴよはいつでも応援してるよ！✨」
     - 正：「いつでもあなたを応援しています。」

7. **タイトル整合性チェック**:
   - **数字の一致**: 「7選」「8選」等のタイトルは実際のコンテンツ数と一致させる
   - **例**: 
     - K027.json: 8つの質問なので「7選」→「8選」に修正
     - K030.json: 具体的な選択肢ではないため「7選」→「悩みを解決」に修正
   - **内容確認**: タイトルが実際のページ構成や提供内容と合致するか必ず確認

8. **複雑構造コンテンツの本質抽出**:
   - **漫画形式の処理**: 複雑なマンガ構造でも伝えたい本質を見抜いて適切なページ構成に変更
   - **構造簡潔化の原則**: scene、character、speech等の複雑なネスト構造を排除
   - **ストーリー保持**: 元の感情の流れとメッセージは保ちつつシンプルな構造に変更
   - **例**: K032.json - マンガ形式9ページを就活不安→成功体験のストーリーとして再構成
   - **重要**: 情報の本質的価値は維持し、表現方法のみ統一テンプレートに適合させる

### 📋 各ナレッジ完了チェックリスト（必須）
**⚠️ 重要**: 以下の全項目を完了せずに「完了」報告することは虚偽報告です

- [ ] pageStructurePatternフィールドにUnifiedテンプレートを設定完了
- [ ] 該当タイプのエビデンスファイルに以下を記録完了：
  - [ ] ファイル名とテンプレート名
  - [ ] Phase 2-2での修正内容（不要な場合は「修正不要」と明記）
  - [ ] 画像配置方針（不要な場合は「画像不要」と明記）
- [ ] 上記エビデンス記載完了後に進捗報告書を更新完了

### 進捗報告書記載項目（シンプル形式）
**進捗報告書パス**: `/mnt/c/instagram-course/instagram-post-generator/pageStructurePattern配置作業進捗報告.md`

記載内容：
- **対象ファイル**: Kxxxファイル名
- **配置テンプレート**: 選択したUnifiedテンプレート名
- **ステータス**: 完了

### 修正エビデンス記録方法
各タイプのエビデンスファイルに以下形式で記録：

**エビデンスファイルパス**:
- Type001: `/mnt/c/instagram-course/instagram-post-generator/detailedContent修正エビデンス_Type001.md`
- Type002: `/mnt/c/instagram-course/instagram-post-generator/detailedContent修正エビデンス_Type002.md`
- Type003: `/mnt/c/instagram-course/instagram-post-generator/detailedContent修正エビデンス_Type003.md`
- Type004: `/mnt/c/instagram-course/instagram-post-generator/detailedContent修正エビデンス_Type004.md`

記録形式（厳守）：

```markdown
### 🔧 [Kxxxファイル名] detailedContent修正エビデンス
- **配置済みテンプレート**: [選択したテンプレート名]

#### 修正後のdetailedContent構造
**修正要否**: [必要/不要]
**修正理由**: [テンプレート適合のために必要な修正内容を簡潔に記載]

#### 🎨 画像配置戦略
**画像要否**: [必要/不要]
**具体的配置**:
- page1: [具体的な画像ファイル名.png] または [画像不要]
- page2: [具体的な画像ファイル名.png] または [画像不要]
```

**⚠️ 記録フォーマット違反例（禁止）**:
- 「既存構造を維持」等の曖昧な記載
- 「推奨キャラ: xxx.png」のような不具体的な指定
- JSON構造の勝手な改変記載

## 注意事項

1. **段階的実行の重要性**: 情報価値低下や構造整合性の問題を防ぐため、必ず段階的に実行
2. **Phase分離の徹底**: Phase 2-1ではpageStructurePattern配置のみ、Phase 2-2でdetailedContent構造改変
3. **情報欠損の完全回避**: 既存情報を一切欠損させず、テンプレートの意図通りに配置する
4. **進捗報告とエビデンス**: 一つずつ完了報告し、detailedContent修正担当にエビデンスを残す
5. **命名規則準拠**: 選択したテンプレートの命名規則に準拠する
6. **テンプレート意図の理解**: 各テンプレートの設計意図を理解し、最適な情報配置を実現する

       305 +  ### ⚠️ 【重要】CTA混入禁止の徹底（2025-07-30追加）
       306 +  - **絶対禁止**: savePrompt、cta等のCTA要素は一切混入させない
       307 +  - **該当フィールド**: 以下のフィールドは空文字または削除する
       308 +    - `"savePrompt": ""` （空文字にする）
       309 +    - `"cta": ""` （空文字にする）
       310 +  - **理由**: ユーザー体験を損なうCTA要素の混入は品質基準違反
       311 +  
       312 +  ### ⚠️ 【重要】テンプレート容量制限の正確な理解（2025-07-30追加）
       313 +  #### unified-template-07-item-list の制限
       314 +  - **最大表示項目数**: 6項目
       315 +  - **12項目等の大量データ**: item-listテンプレートでは表示不可
       316 +  - **対処法**: unified-template-04-item-gridを選択
       317 +  
       318 +  #### unified-template-04-item-grid の構造理解
       319 +  - **基本構成**: 
       320 +    - Page1: basic_intro (必須・スキップ不可)
       321 +    - Page2〜: item_grid (3～6項目×Nページ画像がある場合はMAX4ない場合はMAX6がキレイに配置できます※部分的に画像アリも可ですが、その場合はカラムで統一してください　例：３つの場合　上部のみ画像あり＝〇　下部の２カラムに画像アリ＝〇　下部の１カラムのみ画像アリ＝✖　４つの場合　上部の左右どちらかのみ画像あり＝✖　下部の左右どちらかのみ＝✖　上部２カラムに画像アリで下部２カラムなし＝〇　上部２カラム共画像無し　下部２カラム共画像アリ＝〇　以降奇数、偶数で同じ概念)
       325 +  - **pageCount変更必須**: 元のページ数から適切なページ数に変更
       326 +  
       327 +  #### 構造改変許可条件
       328 +  - **フィードバック有り**: ユーザーからの具体的指摘があれば構造改変を実施
       329 +  - **改変範囲**: pageStructurePattern + pageCount + detailedContent
       330 +  - **情報保持原則**: 全ての元情報を新構造に適切に配分（欠損厳禁）

## コンテンツ完結性の原則（2025-07-29追加）

### 投稿内価値完結の重要性
- **原則**: 全ての投稿は単体で価値を提供し、読者の問題解決に貢献する完結型コンテンツとする
- **禁止事項**: 
  - 外部誘導を前提とした不完全なコンテンツ構成
  - 「詳しくはプロフィールから」等の虚偽的なCTA
  - 問題提起のみで解決策を提示しない構成

### 不完全コンテンツの改善方針
**典型的な不完全パターン**: 
- 失敗体験の共感→「変わりたいなら...」で終了（K037.json参照）
- 問題提起→「解決方法は...」で誘導のみ

**改善構造**:
1. **問題提起・共感**: 読者の悩みに共感
2. **失敗体験**: 具体的な失敗エピソード
3. **気づき・転機**: 何が問題だったかの認識
4. **学んだ教訓**: 失敗から得た具体的な学び
5. **実践的アドバイス**: 読者が今すぐ実践できる具体策
6. **励まし・まとめ**: 前向きなメッセージで締めくくり

### 具体例（K037.json改善例）
- **Before**: インターン合格→油断→失敗→「変わりたいなら...」（未完結）
- **After**: 
  - インターン合格→油断→本選考失敗
  - →インターンと本選考の違いに気づく
  - →継続的な準備の重要性を学ぶ
  - →具体的な準備方法を提示
  - →励ましのメッセージで完結