# ãƒŠãƒ¬ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹å¯¾å¿œãƒ‘ã‚¿ãƒ¼ãƒ³å®Ÿè£…ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

## ğŸ“‹ æ¦‚è¦
ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€æ–°ã—ã„ãƒŠãƒ¬ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹ï¼ˆKxxxï¼‰ã«å¯¾å¿œã—ãŸãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å®Ÿè£…ã™ã‚‹éš›ã®æ¨™æº–çš„ãªãƒ—ãƒ­ã‚»ã‚¹ã‚’ã¾ã¨ã‚ãŸã‚‚ã®ã§ã™ã€‚K002ã®å®Ÿè£…ã‚’ä¾‹ã«ã€å¿…è¦ãªå…¨ã‚¹ãƒ†ãƒƒãƒ—ã‚’ç¶²ç¾…ã—ã¦ã„ã¾ã™ã€‚

## ğŸ¯ å®Ÿè£…ãƒ—ãƒ­ã‚»ã‚¹å…¨ä½“åƒ

### 1. èª¿æŸ»ãƒ•ã‚§ãƒ¼ã‚º

#### 1.1 ãƒŠãƒ¬ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèª
```bash
# å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã®å ´æ‰€
app/data/knowledgeBase/knowledge/K002.json
```

**ç¢ºèªãƒã‚¤ãƒ³ãƒˆï¼š**
- `pageStructurePattern`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å€¤ï¼ˆä¾‹ï¼š`typeID002-sequential-dependency`ï¼‰
- `detailedContent`å†…ã®å„ãƒšãƒ¼ã‚¸ã®æ§‹é€ 
- å„ãƒšãƒ¼ã‚¸ã®`content`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å«ã¾ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿æ§‹é€ 
- ç”»åƒãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼ˆ`illustrationImage`ãªã©ï¼‰ã®æœ‰ç„¡

#### 1.2 æ—¢å­˜ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨ã®ãƒãƒƒãƒãƒ³ã‚°ç¢ºèª
```bash
# ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä¸€è¦§
app/components/templates/
```

**åˆ¤æ–­åŸºæº–ï¼š**
- æ—¢å­˜ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§è¡¨ç¾å¯èƒ½ã‹ï¼Ÿ
- æ–°è¦ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒå¿…è¦ã‹ï¼Ÿ
- å¿…è¦ãªãƒ‡ãƒ¼ã‚¿æ§‹é€ ã¯ä½•ã‹ï¼Ÿ

### 2. ãƒŠãƒ¬ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿®æ­£

#### 2.1 K115å½¢å¼ã¸ã®çµ±ä¸€
å¤ã„å½¢å¼ã®ãƒŠãƒ¬ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹ã¯ã€K115å½¢å¼ã«çµ±ä¸€ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

**å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼š**
```json
{
  "knowledgeId": "K002",
  "pageStructurePattern": "typeID002-sequential-dependency",
  "actualTitle": "ã‚¿ã‚¤ãƒˆãƒ«",
  "pageCount": 8,
  "contentPageCount": 7,
  "detailedContent": {
    "page1": {
      "role": "å°å…¥ãƒ»å•é¡Œæèµ·",
      "layout": "åŸºæœ¬ç´¹ä»‹å½¢å¼", 
      "section": "intro",
      "content": {
        // ãƒšãƒ¼ã‚¸å›ºæœ‰ã®ãƒ‡ãƒ¼ã‚¿
      }
    }
  }
}
```

### 3. ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ç‰¹å®šã¨ãƒšãƒ¼ã‚¸æ§‹é€ å®šç¾©

#### 3.1 ãƒšãƒ¼ã‚¸æ§‹é€ ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ/ç¢ºèª
```bash
# ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹
app/services/knowledgeBase/data/pageStructures/typeID002-sequential-dependency.json
```

**æ§‹é€ ä¾‹ï¼š**
```json
{
  "id": "typeID002-sequential-dependency",
  "name": "TypeID002 é †åºä¾å­˜å‹ã‚¹ãƒ†ãƒƒãƒ—ãƒ•ãƒ­ãƒ¼",
  "pages": [
    {
      "pageNumber": 1,
      "templateId": "basic_intro",
      "templateStructure": {
        "title": "string",
        "targetAudience": "string",
        "problems": "string[]",
        "additionalMessage": "string",
        "savePrompt": "string"
      }
    }
  ]
}
```

#### 3.2 PageStructureMatcherã¸ã®ç™»éŒ²
```typescript
// app/services/knowledgeBase/PageStructureMatcher.ts
import typeID002SequentialDependency from './data/pageStructures/typeID002-sequential-dependency.json'

// structureMappingã«è¿½åŠ 
'typeID002-sequential-dependency': typeID002SequentialDependency
```

### 4. ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ä½œæˆ

#### 4.1 æ–°è¦ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ä½œæˆ
```bash
# ä½œæˆã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ä¾‹
app/components/templates/BasicIntroTemplate.tsx
app/components/templates/StepGuideAchievementTemplate.tsx
```

**ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ§‹é€ ã®åŸºæœ¬å½¢ï¼š**
```typescript
interface TemplateProps {
  data: {
    // å¿…è¦ãªãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å®šç¾©
    title?: string;
    content?: string[];
    illustrationImage?: string; // ç”»åƒä½¿ç”¨æ™‚
  };
}

export default function TemplateComponent({ data }: TemplateProps) {
  const {
    title = '',
    content = [],
    illustrationImage
  } = data || {};
  
  return (
    // JSXã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
  );
}

export const templateMetadata: TemplateMetadata = {
  id: 'template_id',
  name: 'ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå',
  // ãã®ä»–ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
}
```

### 5. ç”»åƒä½¿ç”¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®æ³¨æ„ç‚¹

#### 5.1 ç”»åƒãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å‡¦ç†
- Next.jsã®Imageã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚ˆã‚Šã€é€šå¸¸ã®`<img>`ã‚¿ã‚°ã‚’ä½¿ç”¨
- ãƒ‘ã‚¹ã¯`/public`ãƒ•ã‚©ãƒ«ãƒ€ã‹ã‚‰ã®ç›¸å¯¾ãƒ‘ã‚¹ï¼ˆä¾‹ï¼š`/misaki.png`ï¼‰

#### 5.2 KnowledgeBasedContentGeneratorã§ã®ç”»åƒè£œå®Œ
```typescript
// AIç”Ÿæˆå¾Œã«ç”»åƒãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è£œå®Œã™ã‚‹å‡¦ç†
if (currentPageData?.content?.illustrationImage && !parsedContent.illustrationImage) {
  parsedContent.illustrationImage = currentPageData.content.illustrationImage
}
```

#### 5.3 ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ§‹é€ å®šç¾©ã§ã®ç”»åƒãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
```typescript
'step_guide_achievement': {
  pointNumber: 'string',
  title: 'string',
  content: 'string[]',
  actionItems: 'string[]?',
  illustrationImage: 'string?' // ç”»åƒãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’å¿˜ã‚Œãšã«è¿½åŠ 
}
```

### 6. ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ç™»éŒ²

#### 6.1 index.tsã¸ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆè¿½åŠ 
```typescript
// app/components/templates/index.ts

// ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
export { default as BasicIntroTemplate } from './BasicIntroTemplate'
export { default as StepGuideAchievementTemplate } from './StepGuideAchievementTemplate'

// ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
import BasicIntroTemplate from './BasicIntroTemplate'
import StepGuideAchievementTemplate from './StepGuideAchievementTemplate'

// templateComponentsãƒãƒƒãƒ—ã«è¿½åŠ 
export const templateComponents = {
  // ...æ—¢å­˜ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
  'basic_intro': BasicIntroTemplate,
  'step_guide_achievement': StepGuideAchievementTemplate
}
```

#### 6.2 TemplateTypes.tsã¸ã®å‹è¿½åŠ 
```typescript
// app/components/templates/TemplateTypes.ts
export type TemplateType = 
  | 'existing_templates'
  | 'basic_intro'
  | 'step_guide_achievement'
  // ...
```

#### 6.3 TemplateRegistry.tsã¸ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ç™»éŒ²
```typescript
// app/components/templates/TemplateRegistry.ts
import { basicIntroMetadata } from './BasicIntroTemplate'
import { stepGuideAchievementMetadata } from './StepGuideAchievementTemplate'

export const templateRegistry: Record<TemplateType, TemplateMetadata> = {
  // ...æ—¢å­˜ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
  basic_intro: basicIntroMetadata,
  step_guide_achievement: stepGuideAchievementMetadata
}
```

### 7. å‹•ä½œç¢ºèªã¨ãƒ‡ãƒãƒƒã‚°

#### 7.1 ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°ã®ç¢ºèªãƒã‚¤ãƒ³ãƒˆ
- `ğŸ¯ æ–°ãƒŠãƒ¬ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹èµ·ç‚¹ã‚·ã‚¹ãƒ†ãƒ å®Ÿè¡Œ`
- `ğŸ“‹ ä½¿ç”¨ã™ã‚‹ãƒšãƒ¼ã‚¸æ§‹æˆ:`
- `ğŸ¨ ãƒšãƒ¼ã‚¸Xç”Ÿæˆä¸­...`
- `ğŸ–¼ï¸ ç”»åƒãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è£œå®Œ:`ï¼ˆç”»åƒä½¿ç”¨æ™‚ï¼‰

#### 7.2 ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•

**å•é¡Œ1: ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒè¡¨ç¤ºã•ã‚Œãªã„**
- åŸå› ï¼štemplateComponentsãƒãƒƒãƒ—ã¸ã®ç™»éŒ²æ¼ã‚Œ
- è§£æ±ºï¼šindex.tsã®ç¢ºèª

**å•é¡Œ2: ãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ãæ¸¡ã•ã‚Œãªã„**
- åŸå› ï¼šãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®propsæ§‹é€ ãŒä¸é©åˆ‡
- è§£æ±ºï¼š`data`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‹ã‚‰å±•é–‹ã™ã‚‹å½¢å¼ã«çµ±ä¸€

**å•é¡Œ3: ç”»åƒãŒè¡¨ç¤ºã•ã‚Œãªã„**
- åŸå› ï¼šAIç”Ÿæˆæ™‚ã«ç”»åƒãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒæ¬ è½
- è§£æ±ºï¼šKnowledgeBasedContentGeneratorã§è£œå®Œå‡¦ç†ã‚’è¿½åŠ 

## ğŸ“ ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

æ–°ã—ã„ãƒŠãƒ¬ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹å¯¾å¿œãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å®Ÿè£…ã™ã‚‹éš›ã¯ã€ä»¥ä¸‹ã®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š

- [ ] K***ãƒ•ã‚¡ã‚¤ãƒ«ã®æ§‹é€ ç¢ºèª
- [ ] K115å½¢å¼ã¸ã®çµ±ä¸€ï¼ˆå¿…è¦ãªå ´åˆï¼‰
- [ ] pageStructurePatternã®å€¤ç¢ºèª
- [ ] ãƒšãƒ¼ã‚¸æ§‹é€ å®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ/æ›´æ–°
- [ ] PageStructureMatcherã¸ã®ç™»éŒ²
- [ ] å¿…è¦ãªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ä½œæˆ
- [ ] ç”»åƒãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®æœ‰ç„¡ç¢ºèªã¨å¯¾å¿œ
- [ ] templates/index.tsã¸ã®ç™»éŒ²
- [ ] TemplateTypes.tsã¸ã®å‹è¿½åŠ 
- [ ] TemplateRegistry.tsã¸ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ç™»éŒ²
- [ ] KnowledgeBasedContentGeneratorã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ§‹é€ å®šç¾©æ›´æ–°
- [ ] å‹•ä½œç¢ºèªï¼ˆã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°ç¢ºèªï¼‰
- [ ] ç”»åƒè¡¨ç¤ºã®ç¢ºèªï¼ˆç”»åƒä½¿ç”¨æ™‚ï¼‰

## ğŸš€ å®Ÿè£…ã®æµã‚Œï¼ˆè¦ç´„ï¼‰

1. **èª¿æŸ»**: Kxxxãƒ•ã‚¡ã‚¤ãƒ«ã®æ§‹é€ ã‚’ç¢ºèª
2. **ä¿®æ­£**: K115å½¢å¼ã«çµ±ä¸€ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰
3. **å®šç¾©**: ãƒšãƒ¼ã‚¸æ§‹é€ å®šç¾©ã‚’ä½œæˆ/ç¢ºèª
4. **ä½œæˆ**: å¿…è¦ãªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å®Ÿè£…
5. **ç™»éŒ²**: å„ç¨®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«ç™»éŒ²
6. **ç¢ºèª**: å‹•ä½œç¢ºèªã¨ãƒ‡ãƒãƒƒã‚°

ã“ã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã«å¾“ã†ã“ã¨ã§ã€æ–°ã—ã„ãƒŠãƒ¬ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹å¯¾å¿œãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’åŠ¹ç‡çš„ã‹ã¤ç¢ºå®Ÿã«å®Ÿè£…ã§ãã¾ã™ã€‚