# 📋 フォーマッタープロンプト完全分析

## 概要
ResearchFormatter.tsxで使用されるフォーマッタープロンプトの完全分析。リサーチ結果をInstagram投稿生成システム用に変換する際のプロンプトを詳細に記録。

## 1. Strategy（対策系）フォーマッタープロンプト

### genreConfigsの設定
```typescript
{
  id: 'strategy',
  name: '対策系',
  description: '面接・ES・試験対策',
  template: 'チェックリスト構造',
  outputFormat: `【ジャンル】: strategy

[インデックスタイトル]！[対策方法の有益性を表現する後半タイトル]

□ [対策項目1]
  [リサーチから得られた生の具体的な準備方法]
  [失敗パターンの回避策]

□ [対策項目2]
  [リサーチから得られた生の具体的な準備方法]
  [失敗パターンの回避策]

□ [対策項目3]
  [リサーチから得られた生の具体的な準備方法]
  [失敗パターンの回避策]`,
  specificRules: [
    '4-6個の対策項目をチェックリスト形式で整理',
    '具体的な準備方法と注意点を含める',
    '専門家のアドバイスを根拠として組み込み',
    '成功事例から具体的な行動を抽出',
    '失敗パターンを回避方法として表現'
  ]
}
```

### 実際に生成される完全プロンプト（strategy）
```
【リサーチ結果フォーマット変換指示】

以下の詳細なリサーチ結果を、Instagram投稿生成システム用の対策系フォーマットに変換してください。

【入力】: [リサーチデータ]

【変換要件】
1. **ジャンル指定**: 冒頭に「【ジャンル】: strategy」を必ず記載
2. **タイトル形式**: 「[インデックスタイトル]！[有益性を表現する後半タイトル]」形式で、strategy系は「！」を使用
   - インデックスタイトル: メインページの一覧で表示されるタイトル
   - 後半タイトル: ページの有益性を表現する部分
3. **チェックリスト構造**: 4-6個の対策項目をチェックリスト形式で整理、具体的な準備方法と注意点を含める、専門家のアドバイスを根拠として組み込み、成功事例から具体的な行動を抽出、失敗パターンを回避方法として表現

【出力形式】
【ジャンル】: strategy

[インデックスタイトル]！[対策方法の有益性を表現する後半タイトル]

□ [対策項目1]
  [リサーチから得られた生の具体的な準備方法]
  [失敗パターンの回避策]

□ [対策項目2]
  [リサーチから得られた生の具体的な準備方法]
  [失敗パターンの回避策]

□ [対策項目3]
  [リサーチから得られた生の具体的な準備方法]
  [失敗パターンの回避策]

【重要な変換ルール】
✅ リサーチの生の情報をそのまま記載（要約や解釈しない）
✅ 専門家の見解を根拠として組み込み
✅ 成功事例から具体的な行動を抽出
✅ 失敗パターンを回避する方法として表現
✅ 最新トレンドを取り入れた現代的な手法
✅ リサーチから得た数値、統計、固有名詞、具体事例をそのまま使用

❌ 絵文字は一切使用しない
❌ 存在しない情報を勝手に補完しない
❌ 推測や憶測による肉付けは行わない
❌ リサーチにない根拠は作らない
❌ 情報の信頼性を損なう表現は避ける
❌ リサーチ情報を要約や解釈しない（生の情報を保持）

【最終チェック項目】
□ 【ジャンル】: strategy が記載されている
□ タイトルが指定形式（前半：後半または前半！後半）
□ チェックリスト構造で適切に構成
□ 各項目が実践的で具体的
□ リサーチの生の情報がそのまま記載されている
□ 論理的な順序で配置されている
□ 初心者でも理解できる内容
□ 「やってみたい」と思わせる表現
```

## 2. Industry-features（業種特徴系）フォーマッタープロンプト

### genreConfigsの設定
```typescript
{
  id: 'industry-features',
  name: '業種特徴系',
  description: '業界・業種のデータ可視化と分析',
  template: '柔軟ページ構成（INDEX + 複数ランキング + グラフ + ハウツー）',
  outputFormat: `【ジャンル】: industry-features

【データ可視化投稿 - 複数ランキング・ハウツー対応】

## ページ0: INDEX（目次）
 [メインタイトル]：[統計データテーマ]の[業界/職種]データ分析

### セクション: 今回の投稿内容
- [ランキング項目] - [具体的な調査名・年度]
- [円グラフ項目] - [具体的な調査名・年度]
- [棒グラフ項目] - [具体的な調査名・年度]
- [ハウツー項目] - [就活生向け実践チェックリスト]

## ページ1: ランキングデータ（メイン）
[ランキング項目名]

### ランキングデータ（上位5位）
1位: [項目名] - [数値]% ([2人に1人が～等の分かりやすい表現])
2位: [項目名] - [数値]%
3位: [項目名] - [数値]%
4位: [項目名] - [数値]%
5位: [項目名] - [数値]%

【出典】: [組織名][調査年]年調査（[発表年月日]発表）

[以下、複数ページ構成...]`,
  specificRules: [
    '複数ランキング・ハウツーは適切にページ分割（INDEX + 複数ランキング + グラフ + 分割ハウツー）',
    'INDEXタイトルは就活生向け表現',
    'すべてのデータに出典を明記（組織名・調査年・発表日付）',
    'ランキングは必ず上位5位まで記載、1位には分かりやすい表現を追加',
    'グラフデータは具体的な数値とパーセンテージを含める',
    'ハウツーは「〜を見極める就活生向けチェックリスト」形式',
    '統計データは政府・業界団体・シンクタンク等信頼できる組織のみ',
    '出典形式は「[組織名][調査年]年調査（[発表年月日]発表）」で統一',
    '【タイトル形式統一要件】全ページで「：」を使用した統一形式（例：「IT業界年収ランキング：稼げる職種TOP5」）',
    '[]や【】などの装飾記号は使用しない（出典を除く）',
    '調査機関名は出典に記載し、タイトルは簡潔に保つ',
    '感嘆符（！）の使用は最小限に抑える',
    'タイトルは25文字以内で収める'
  ]
}
```

### 実際に生成される完全プロンプト（industry-features）
[上記と同様の詳細なプロンプト構造]

## 🔍 フォーマッタープロンプトの特徴分析

### 1. 共通要素
- **ジャンル指定**: 冒頭に必ず「【ジャンル】: [ジャンル名]」を記載
- **タイトル形式**: 前半：後半形式（strategy は「！」、industry-features は「：」）
- **リサーチ情報の保持**: 要約や解釈せず、生の情報をそのまま記載
- **絵文字禁止**: 一切使用しない
- **推測禁止**: 存在しない情報を補完しない

### 2. Strategy特有の要素
- **チェックリスト構造**: □記号を使用した4-6個の対策項目
- **2段階構成**: 準備方法 + 失敗パターンの回避策
- **実践的内容**: 具体的な行動指針

### 3. Industry-features特有の要素
- **柔軟ページ構成**: INDEX + 複数ランキング + グラフ + ハウツー
- **データ重視**: 統計、出典、数値の正確な記載
- **最大8ページ**: 情報量に応じた分割対応
- **出典形式統一**: [組織名][調査年]年調査（[発表年月日]発表）

## 📊 フォーマッターとPageStructureAnalyzerの関係

### フォーマッターの役割
1. **リサーチ結果を構造化**: 生のリサーチデータを定型フォーマットに変換
2. **ジャンル明示**: 【ジャンル】タグを付与
3. **□記号付与**: strategyの場合、チェックリスト形式を明示

### PageStructureAnalyzerへの影響
フォーマッターが出力した構造化テキストが、PageStructureAnalyzerの入力となる：
- strategy → □記号付きチェックリスト構造
- industry-features → ページ番号付きの複雑な構造

### 問題の核心
**フォーマッターは正しく□記号を付けているが、PageStructureAnalyzerがそれを適切に認識していない**

## 💡 改善への示唆

### 1. フォーマッター側は問題なし
- strategyジャンルで確実に□記号を生成
- チェックリスト構造を明示的に作成

### 2. PageStructureAnalyzer側の改善必要
- □記号の明示的な認識
- strategyジャンル + □記号 → checklist-enhanced の強制選択
- ジャンル特性の優先適用

### 3. 連携の強化
- フォーマッターが付与した構造情報をより活用
- ジャンルタグを最優先の判定基準に