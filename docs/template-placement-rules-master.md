# テンプレート配置ルールマスタードキュメント

## 🎯 基本原則（最重要）

### 1. 情報欠損の完全回避
- **既存情報の完全保持**: detailedContentの全ての情報価値を一切落とさず、欠損させない
- **段階的移行**: 元の構造から新しいテンプレート構造への情報を段階的に移行
- **検証必須**: 移行前後で情報の漏れがないことを必ず確認

### 2. CTA混入絶対禁止（2025-07-30追加）
- **savePrompt**: 削除する
- **cta**: 削除する
- **理由**: ユーザー体験を損なうCTA要素の混入は品質基準違反

### 3. 文体・表記統一原則
- **ですます調の徹底**: 全てのコンテンツはですます調で統一
- **丁寧語の維持**: 読者に対する敬意を保った文体
- **一貫性の確保**: 同一ナレッジ内での文体ブレを防止
- **ナンバリング禁止（2025-07-30追加）**: ①②③、1.2.3.等の番号付けは不要。テンプレートにナンバーフィールドがない限り使用禁止

### 3. 情報の適切な配置
- **重要情報の優先配置**: 最も伝えたい内容を読者の視線が最初に向かう位置に配置できるテンプレートを選ぶ
- **読者導線の最適化**: 情報の重要度に応じた適切な配置順序ができるテンプレートを選ぶ

## オーバーライド機能の理解と活用

### オーバーライドの具体的仕組み（K118参考例）
- **templateOverridesフィールド使用**: 特定ページで異なるテンプレートを指定
- **実装例**:
  ```json
  "templateOverrides": {
    "2": "unified-template-05-comparison",
    "3": "unified-template-08-section-blocks", 
    "4": "unified-template-04-item-grid"
  }

  ```
  3. **内容に応じたテンプレート選択**:
   - NG/GOOD比較 → `unified-template-05-comparison`
   - カテゴリ説明 → `unified-template-08-section-blocks`
   - マトリックス → `unified-template-04-item-grid`

- **ページ単位での個別指定**: ページ2でng_good_comparison、ページ3-4でcategory_explanationを使用
- **基本構造との併用**: pageStructurePatternの基本構造を維持しつつ特定ページのみカスタマイズ

### ⚠️ 重要な制約事項・作業分離
- **Phase 2-1での改変対象**: pageStructurePatternフィールドの配置のみ
- **Phase 2-2での改変対象**: detailedContentの構造改変（情報欠損防止・テンプレート最適配置）
- **構造改変の目的**: テンプレートの意図通りに情報を配置し、情報価値を最大化する
- **改変範囲の限定**: detailedContentのみが対象、その他フィールドは改変しない

## 📋 Unifiedテンプレート一覧と制限事項

### unified-template-01-simple-intro
- **適用対象**: シンプルな導入コンテンツ
- **配置重点**: タイトルと説明文の明確な配置
- **注意点**: 画像とテキストのバランス

### unified-template-02-dual-section  
- **適用対象**: 2つの要素を対比・並列表示するコンテンツ
- **配置重点**: 上下セクションの論理的関係性
- **注意点**: セクション間の情報格差の回避

### unified-template-03-ranking-display
- **適用対象**: ランキング・順位付けコンテンツ  
- **配置重点**: 順位の根拠と評価基準の明示
- **注意点**: ランキング以外の情報の適切な配置

### unified-template-04-item-grid
- **適用対象**: 複数アイテムの並列紹介
- **配置重点**: 各アイテムの情報密度の均等化
- **⚠️ 重要な制限**:
  - **基本構成**: Page1: basic_intro (必須・スキップ不可) + Page2〜: item_grid
  - **表示制限**: 3～6項目×Nページ（画像がある場合はMAX4、ない場合はMAX6）
  - **画像配置ルール**: 
    - 3項目: 上部のみ画像あり＝○　下部2カラムに画像アリ＝○　下部1カラムのみ画像アリ＝✖
    - 4項目: 上部左右どちらかのみ画像あり＝✖　上部2カラム画像アリ+下部2カラム画像なし＝○
  - **pageCount変更必須**: 元のページ数から適切なページ数に変更

#### 🔥 重要原則: 画像一致性優先による数量調整（2025-07-30追加）
- **基本思想**: キリの良い数（12個等）より、画像とアイテムの一致性を優先
- **K009事例**: 12個→10個調整により画像一致性と○パターン配置を実現
- **判断基準**: 
  1. 利用可能な一致画像数を確認
  2. ○パターン配置が可能な構成を検討
  3. 一致しない画像のアイテムは削除対象として検討
  4. 数量よりも品質・視覚的統一性を重視
- **適用例**: AIツール紹介で実際のツールロゴが利用可能な数に合わせて全体数を調整

#### 📊 AIツール削除優先順位基準（2025-07-30追加）
**適用対象**: AIツール系コンテンツで数量調整が必要な場合

**削除優先順位（高→低）**:
1. **画像なし・不一致ツール**: 対応する正確な画像がないツールを最優先で削除
2. **用途重複ツール**: 同じ用途で複数あるうち知名度の低いもの
3. **マイナーツール**: 一般的な認知度が低く、専門性が高すぎるツール
4. **初心者向け不適合**: ターゲット層（初心者/中級者）に適さないツール
5. **実用性の低さ**: 実際の利用頻度が低いツール

**保持優先順位（高→低）**:
1. **主要ツール**: ChatGPT、Gemini、Perplexity等の高知名度ツール
2. **用途代表ツール**: 各用途（文章/画像/音楽等）の代表的ツール
3. **初心者適合ツール**: 学習コストが低く使いやすいツール
4. **画像完全一致ツール**: 正確な公式ロゴ・アイコンが利用可能
5. **実用性の高さ**: 実際によく使われる実用的ツール

**決定プロセス**:
1. 利用可能な正確画像数を確認
2. ○パターン配置可能な数量を算出
3. 上記基準で保持/削除を決定
4. 最終的な数量とページ構成を確定

### unified-template-05-comparison
- **適用対象**: 比較・対比型コンテンツ
- **配置重点**: 比較軸の明確化と公平な情報配置
- **注意点**: 左右セクションの情報量バランス

### unified-template-06-company-detail
- **適用対象**: 企業・組織の詳細紹介
- **配置重点**: 企業の特徴的な情報の効果的配置
- **注意点**: 定量的情報の正確な表示
- **⚠️ 重要な適用基準（2025-07-30追加）**: 
  - **情報量判定**: 1企業あたり複数の詳細データ（年収・休日・残業・福利厚生等）が必要
  - **不適用例**: 企業名+単一情報（家賃補助金額のみ等）は情報量不足でテンプレート不適合
  - **K021事例**: 企業名+家賃補助額のみ → unified-template-09-dynamic-boxesに変更

### unified-template-07-item-list
- **適用対象**: リスト形式のコンテンツ
- **配置重点**: リスト項目の論理的順序
- **⚠️ 重要な制限**: **最大表示項目数6項目**
- **12項目等の大量データ**: item-listテンプレートでは表示不可 → unified-template-04-item-gridを選択　or ページを分割してユーザーに読みやすくする

### unified-template-08-section-blocks
- **適用対象**: セクション別に分けた情報提供
- **配置重点**: セクション間の関連性と独立性のバランス
- **注意点**: セクション内情報の完結性

### unified-template-09-dynamic-boxes
- **適用対象**: 動的・柔軟な情報ボックス
- **配置重点**: ボックス内情報の自己完結性
- **注意点**: ボックス間の情報格差の管理
- **⚠️ 最適適用ケース（2025-07-30追加）**:
  - **企業名+単一特徴**: 企業詳細型には情報量不足だが価値ある情報
  - **4項目×2ページ構成**: 情報密度とページ数のバランスが最適
  - **K021事例**: 家賃補助企業8社 → 4社ずつ2ページで視覚的に整理
  - **命名規則厳守**: title, boxes[{name, content}]構造への完全準拠必須

### unified-template-10-image-point
- **適用対象**: 画像中心のポイント説明
- **配置重点**: 画像とテキストの相互補完関係
- **注意点**: 重要ポイントの視覚的強調

## 🎨 投稿タイプ別特別ルール

### Type001 (感情共感型) - 完了済み
- **ステータス**: ✅ 作業完了
- **基本テンプレート**: unified-template-01-simple-intro
- **詳細ルール**: 本ドキュメント末尾の「Type001詳細ルール（参考資料）」を参照

### Type002 (実践習得型)  
- **配置重点**: 実践ステップの論理的順序
- **注意事項**: アクション可能な情報の明確化
- **画像使用**: 内容的に配置した方が伝わる場合のみ

### Type003 （ランキング・Tier表など情報型）
- **既存設定の維持**: 現在の配置を基本的に保持
- **必要時のみ調整**: 重大な問題がある場合のみ変更検討
- **推奨テンプレート**: unified-template-03-ranking-display、unified-template-06-company-detail

### Type004 (ツールなど並列紹介型)
- **配置重点**: ツールなどを順序に依存せず並列で紹介・解説する
- **注意事項**: データの正確性と完全性の確保
- **画像使用**: AIツール画像、企業画像を効果的に活用

## 📷 画像使用ガイドライン

### 使用可能画像リソース

#### AIツール関連画像 (`/public/imag/ai/`)
- Adobe_Firefly_Logo.png, ChatGPT-Logo.png, claude-ai-icon.png, copilot.png, gamma.png, Google-Gemini-1.png, mymind.png, Napkin-ai.png, NotebookLM_logo.png, perplexity.png
- **用途**: Type004のAIツール比較・紹介コンテンツ

#### 企業関連画像 (`/public/imag/company/`)  
- accenture.png, baincompany.png, bcg.png, canon.png, goldmansachs.png, google.png, honda.png, keyence.png, mckinsey.png, meta.png, mitsubishisyouji.png, mitsuibussan.png, nttdata.png, nufg.png, rakuten.png, softbank.png, sony.png, sumitomosyouji.png, takeda.png, tokiomarine.png
- **用途**: Type003の企業紹介コンテンツ

#### キャラクター画像 (`/public/`)
- **通常表情**: iida.png, kikuyo.png, king.png, misaki.png, ten.png（基本的に笑顔）
- **困り顔**: iida_worry.png, kikuyo_worry.png, king_worry.png, misaki_worry.png, ten_worry.png
- **仕事関連**: misaki_work.png（楽しそうに仕事）, misaki_busy.png（忙しそうに仕事）
- **学習・状態**: misaki_study.png（勉強中）, iida_fighting.png（モチベーション高）, iida_sleepy.png（眠そう）, iida_sorry.png（謝罪）
- **ポイント説明**: kikuyo_point.png（女性が重要ポイントを教えてくれてるポーズ）, king_point.png（男性が重要ポイントを教えてくれてるポーズ）
- **チームワーク**: team_work.png（チームワーク・会議イラスト）
- **用途**: 各投稿タイプに応じて適切に選択
- **選択基準**: ターゲットの性別・内容に応じて適切なキャラクターを選択

### 画像使用ルール
1. **同一画像の連続使用禁止**: メインコンテンツで同じ画像を連続使用しない
2. **バランス考慮**: 同ページ内で画像ありとなしが混在するのは避ける
3. **テキスト量との調整**: テキスト量が少ないページは画像追加を検討
4. **オプショナル要素への配慮**: シンプルテンプレートでも画像なしはバランスが悪い

## 🔄 作業フロー

### Phase 2-1: pageStructurePattern配置フロー
1. **既存パターンの確認**: 現在設定されているpageStructurePatternを確認
2. **⚠️ Unified既存判定**: 既にunified-template-系が設定されている場合はテンプレート変更不要
3. **detailedContent構造適合性検証**: 既存・新規問わず、選択テンプレートで情報欠損なく表示可能かを検証
4. **Unifiedテンプレート選択**: 非Unified系のみ10種類から最適なテンプレートを選択
5. **パターン配置**: 選択したUnifiedテンプレートをpageStructurePatternフィールドに設定
6. **🔧 テンプレート構造適合性修正（2025-07-30追加）**: detailedContentを正確なテンプレート構造に修正
7. **【必須】修正エビデンス記録**: 構造適合性検証結果を含む修正内容を記録（構造改変不要の場合も「修正不要」として必ず記載）
8. **進捗報告書更新**: エビデンス記載完了後に進捗報告書を更新

#### 🎯 テンプレート構造適合性の重要性（2025-07-30追加）
- **必須作業**: テンプレート選択後は必ずdetailedContentを正確な構造に修正
- **K012事例**: CompanyDetailTemplate適用時、`content{header, company, companyInfo}`→`companyName, features, details`構造への完全変更
- **K021事例**: DynamicBoxesTemplate適用時、複雑な企業紹介構造→`title, boxes[{name, content}]`構造への簡潔化
- **構造不適合の問題**: テンプレート選択のみでdetailedContent未修正の場合、レンダリング時にエラーまたは表示不具合が発生

#### 📋 主要テンプレート構造要件（2025-07-30追加）

**unified-template-04-item-grid**:
```json
{
  "title": "string",
  "subtitle": "string", 
  "items": [{
    "name": "string",
    "description": "string", 
    "imageSrc": "string (optional)",
    "imageAlt": "string (optional)"
  }]
}
```

**unified-template-06-company-detail**:
```json
{
  "companyName": "string",
  "features": {
    "industry": "string",
    "salary": "string",
    "holidays": "string", 
    "overtime": "string"
  },
  "details": {
    "overview": "string",
    "recruitment": ["string"],
    "hiringCount": "string"
  },
  "highlightMessage": "string"
}
```

**unified-template-09-dynamic-boxes**:
```json
{
  "title": "string",
  "boxes": [{
    "name": "string",
    "content": "string"
  }]
}
```

### 構造改変許可条件
- **フィードバック有り**: ユーザーからの具体的指摘があれば構造改変を実施
- **改変範囲**: pageStructurePattern + pageCount + detailedContent
- **情報保持原則**: 全ての元情報を新構造に適切に配分（欠損厳禁）

## ✅ 品質保証チェックリスト

### 配置前チェック
- [ ] 元のdetailedContentの全情報を把握
- [ ] 適切なUnifiedテンプレートを選択
- [ ] オーバーライドの必要性を評価

### 配置中チェック  
- [ ] 重要情報の適切な位置への配置
- [ ] ですます調の文体統一
- [ ] テンプレート構造との適合性

### 配置後チェック
- [ ] 情報の欠損・重複がないことを確認
- [ ] 読者導線の最適性を検証
- [ ] 同一タイプ内での一貫性を確認

### 📋 各ナレッジ完了チェックリスト（必須）
**⚠️ 重要**: 以下の全項目を完了せずに「完了」報告することは虚偽報告です

- [ ] pageStructurePatternフィールドにUnifiedテンプレートを設定完了
- [ ] 該当タイプのエビデンスファイルに以下を記録完了：
  - [ ] ファイル名とテンプレート名
  - [ ] Phase 2-2での修正内容（不要な場合は「修正不要」と明記）
  - [ ] 画像配置方針（不要な場合は「画像不要」と明記）
- [ ] 上記エビデンス記載完了後に進捗報告書を更新完了

## 📝 エビデンス記録方法

### 修正エビデンス記録フォーマット（厳守）

**エビデンスファイルパス**:
- Type001: `/mnt/c/instagram-course/instagram-post-generator/detailedContent修正エビデンス_Type001.md`
- Type002: `/mnt/c/instagram-course/instagram-post-generator/detailedContent修正エビデンス_Type002.md`
- Type003: `/mnt/c/instagram-course/instagram-post-generator/detailedContent修正エビデンス_Type003.md`
- Type004: `/mnt/c/instagram-course/instagram-post-generator/detailedContent修正エビデンス_Type004.md`

**記録形式**：
```markdown
### 🔧 [Kxxxファイル名] detailedContent修正エビデンス
- **配置済みテンプレート**: [選択したテンプレート名]

#### 修正後のdetailedContent構造
**修正要否**: [必要/不要]
**修正理由**: [テンプレート適合のために必要な修正内容を簡潔に記載]

#### 🎨 画像配置戦略
**画像要否**: [必要/不要]
**具体的配置**:
- page1: [具体的な画像ファイル名.png] または [画像不要]
- page2: [具体的な画像ファイル名.png] または [画像不要]
```

### 進捗報告書記載項目（シンプル形式）
**進捗報告書パス**: `/mnt/c/instagram-course/instagram-post-generator/pageStructurePattern配置作業進捗報告.md`

記載内容：
- **対象ファイル**: Kxxxファイル名
- **配置テンプレート**: 選択したUnifiedテンプレート名
- **ステータス**: 完了

## 🎯 コンテンツ完結性の原則（2025-07-29追加）

### 投稿内価値完結の重要性
- **原則**: 全ての投稿は単体で価値を提供し、読者の問題解決に貢献する完結型コンテンツとする
- **禁止事項**: 
  - 外部誘導を前提とした不完全なコンテンツ構成
  - 「詳しくはプロフィールから」等の虚偽的なCTA
  - 問題提起のみで解決策を提示しない構成

### 不完全コンテンツの改善方針
**典型的な不完全パターン**: 
- 失敗体験の共感→「変わりたいなら...」で終了（K037.json参照）
- 問題提起→「解決方法は...」で誘導のみ

### 具体例
- **Before**: インターン合格→油断→失敗→「変わりたいなら...」（未完結）
- **After**: 
  - インターン合格→油断→本選考失敗
  - →インターンと本選考の違いに気づく
  - →継続的な準備の重要性を学ぶ
  - →具体的な準備方法を提示
  - →励ましのメッセージで完結

**改善構造**:
1. **問題提起・共感**: 読者の悩みに共感
2. **失敗体験**: 具体的な失敗エピソード
3. **気づき・転機**: 何が問題だったかの認識
4. **学んだ教訓**: 失敗から得た具体的な学び
5. **実践的アドバイス**: 読者が今すぐ実践できる具体策
6. **励まし・まとめ**: 投稿タイプ・内容に合ったしめくくり

## 🗑️ ナレッジファイル削除基準・手順（2025-07-30追加）

### 削除対象の判定基準（厳格適用）

#### ✅ 削除適用対象
1. **時限性情報の完全失効**:
   - 明確な締切日・期限が設定されており、その期限が完全に経過した情報
   - 例：「7/13〜20締切 夏インターン企業30選」（K035事例）
   - 判定基準：全ての締切日が現在日付より過去

2. **情報鮮度の著しい劣化**:
   - 年度指定情報で対象年度が2年以上経過（例：27卒情報を29卒以降が見る場合）
   - 制度変更により内容が完全に陳腐化した情報

#### ❌ 削除禁止対象（誤削除防止）
1. **恒常的価値を持つ情報**:
   - 就活ノウハウ、面接対策、自己PR手法等の普遍的内容
   - 企業研究方法、業界分析手法等の方法論

2. **更新可能な情報**:
   - 年度や数値を変更すれば再利用可能な情報
   - 企業リスト等で企業名のみ変更すれば有効な情報

3. **一時的な情報不足**:
   - 単に情報が古いが、更新により価値回復可能な情報

### 🔍 削除前必須チェックリスト

#### Phase 1: 削除可否の慎重判定
- [ ] **時限性の確認**: 明確な期限設定があり、全期限が経過済みか？
- [ ] **更新可能性の検討**: 部分修正で価値回復可能か？
- [ ] **代替コンテンツの存在**: 同様の価値を提供する他のナレッジが存在するか？
- [ ] **ユーザー影響度**: 削除によりユーザー体験が著しく損なわれないか？

#### Phase 2: 削除実行前エビデンス記録（必須）
- [ ] **削除理由の詳細記録**: detailedContent修正エビデンスファイルに完全記録
- [ ] **元情報価値の分析**: 削除前の情報価値を客観的に記録
- [ ] **関連システム影響確認**: type-target-persona-relations.json等の関連ファイル確認

#### Phase 3: 削除実行とクリーンアップ
- [ ] **ファイル削除実行**: `rm`コマンドによる物理削除
- [ ] **関連設定除去**: type-target-persona-relations.jsonからの参照完全除去
- [ ] **進捗報告更新**: 削除完了を進捗報告書に明記

### 📝 削除エビデンス記録フォーマット（厳守）

```markdown
### 🗑️ [ファイル名] 削除エビデンス
- **元配置テンプレート**: [配置予定・済みテンプレート]
- **削除理由**: [具体的な削除理由]
- **削除判定**: [判定日時と判定基準]

#### 削除前の情報価値分析
**元コンテンツ**: [元のタイトル・概要]
**情報価値**: 
- [削除前の主要な情報価値を箇条書き]

**削除理由**:
1. **[理由カテゴリ]**: [具体的説明]
2. **[理由カテゴリ]**: [具体的説明]

#### type-target-persona-relations.json修正要否
**修正要否**: [必要/不要]
**修正内容**: [具体的な修正内容]
```

### ⚠️ 削除時の重要注意事項

1. **削除は最後の手段**: 更新・修正による価値回復を最優先検討
2. **チーム合意の推奨**: 可能な限りチームメンバーとの合意形成
3. **バックアップ前提**: 削除実行前に必要に応じてバックアップ取得
4. **段階的削除**: 一度に大量削除せず、1件ずつ慎重に実行
5. **削除後検証**: システム動作に影響がないことを確認

## ⚠️ 重要な注意事項

1. **段階的実行の重要性**: 情報価値低下や構造整合性の問題を防ぐため、必ず段階的に実行
2. **Phase分離の徹底**: Phase 2-1ではpageStructurePattern配置のみ、Phase 2-2でdetailedContent構造改変
3. **情報欠損の完全回避**: 既存情報を一切欠損させず、テンプレートの意図通りに配置する
4. **進捗報告とエビデンス**: 一つずつ完了報告し、detailedContent修正担当にエビデンスを残す
5. **命名規則準拠**: 選択したテンプレートの命名規則に準拠する
6. **テンプレート意図の理解**: 各テンプレートの設計意図を理解し、最適な情報配置を実現する
7. **削除基準の厳格適用**: 上記削除基準に該当しない限り、ナレッジファイルの削除は禁止

---

## 📚 参考資料: Type001詳細ルール（完了済み）

### Type001 (感情共感型) - 特別ルール
- **基本テンプレート**: `unified-template-01-simple-intro`が基本適合（感情共感重視設計）
- **⚠️ 重要**: キャラクターとの感情的つながりが核心。情報量より感情共感の質を重視

#### Type001専用ルール（2025-07-29追加）
1. **ページ分割の推奨**: 複数項目が1ページに詰め込まれている場合、感情共感を深めるため各項目を個別ページに分割
   - 分割時は元の情報を一切欠損させないこと。全ての説明文、詳細情報を適切に各ページに配分

2. **画像設定の正しい形式**: 
   - 正：`"imageSrc": "/misaki.png"`
   - 誤：`"imageFile": "misaki.png"`

3. **セクション統一ルール**: 
   - introduction（page1のみ）
   - mainContent（page2以降すべて統一）
   - summaryは使用せず、最終ページもmainContent

4. **構造の簡潔化**: 
   - ネストした複雑なcontent構造は避ける
   - シンプルなtitle/content/imageSrc構造に統一
   - **注意**: 簡潔化は構造のみ。コンテンツ内容は全て保持すること

5. **文体・表現の統一ルール**:
   - **固有名詞の排除**: 「元大手人事部」「ぴよこ」等の固有名詞・キャラクター名は使用しない
   - **口調の統一**: ですます調 + 落ち着いた優しい大人の口調
   - **絵文字の排除**: ✨、◎、！等の絵文字は使用しない

6. **タイトル整合性チェック**:
   - **数字の一致**: 「7選」「8選」等のタイトルは実際のコンテンツ数と一致させる
   - **内容確認**: タイトルが実際のページ構成や提供内容と合致するか必ず確認

7. **複雑構造コンテンツの本質抽出**:
   - **漫画形式の処理**: 複雑なマンガ構造でも伝えたい本質を見抜いて適切なページ構成に変更
   - **構造簡潔化の原則**: scene、character、speech等の複雑なネスト構造を排除
   - **ストーリー保持**: 元の感情の流れとメッセージは保ちつつシンプルな構造に変更

8. **特別許可事項**: 
   - Type001に限り、Phase 2-1でも情報価値向上のためdetailedContent構造改変を実施可能
   - ただし、pageCountの変更も忘れずに実施すること
   - **原則**: 情報価値の向上のみが目的。情報の削除や省略は厳禁

#### 画像配置必須ルール（Type001）
- 複数キャラクター使用（同一キャラクター連続使用禁止）
- 感情の流れに応じた表情選択（困りごと→worry、解決→通常表情）
- 8ページ構成では最低4-5種類のキャラクター＋表情バリエーション必要
- **感情表現の適切なレベル**: 不必要に感情の抑揚を作りすぎない。悩み（worry）→通常（笑顔）程度の自然な感情変化