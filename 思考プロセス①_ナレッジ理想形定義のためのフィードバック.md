# 思考プロセス① - ナレッジ理想形定義のためのフィードバック

## 基本方針
今ナレッジKxxxを私の求める理想のナレッジにしようとしています　具体的にまだどのような方向性でどうやって修正するかは決定しておらず今はそれを考えてる段階です

## 現状のKxxxランダムサンプリングフィードバック

**003** 根拠のない実践エピソードなのでナレッジではない
また、ページ２がメインコンテンツだが、大した情報はない

**004** CTAページが混入している

**005** フォーマットページストラクチャーなし　テンプレートべた書き

**007** 仕事が早い人と同じ角度・切り口　これを転職にした感じ

**008** 根本的　装飾まだ入ってる　３ページの中に投稿的価値無し→削除

**009** 良くはなってるけどCTAと装飾がページごとに混入してる　ページもCTAが２つも混入してる　１ページ目は悪くない

**010** フォーマットが大幅に改変されてる　内容自体は悪くない　装飾が混入してる　CTAページが混入してる

## 共通ルール
全部共通でページ１は投稿タイプごとの決まったテンプレートを使用する

入力テキストによってページ１は多少変わるように工夫

**011** フォーマット　アカウント情報が入ってる　謎の？？？表記　装飾が混入してる　ページ番号の表記が違う　numberの表記が違う　根拠のない出典フィールドがある　CTAページが混入してる

**012** ページ番号の表記が違う　装飾が混入してる　謎のいいね　保存表記が混入してる　タイトルページが混入してる　ページの画像指定がmascotという謎の指示？　実在する画像じゃないしパスでもない

**013～015** まで存在しない

**016** 根本的　投稿的価値無し

**017** ページストラクチャーなし　タイトルページが混入してる　ページごとに装飾が混入してる　フォロワーから募集したという根拠のない記述が入ってる　口調が他のナレッジと統一されてない　CTAページが混入している

**018** 導入ページが存在せず、タイトルページとCTAページが混入している　６，７ページ共にCTAページ

**019～020** 存在しない

**021** タイトルページが混入している　導入がない　フォーマット　ページインジケータとかいう無駄なフィールドがある　並列紹介だが、１ページに一つの紹介であれば画像は必須　CTAページが混入している　フォーマットの正解は　132が基本的に正解

**133** シゴデキという略語を使用している　これ自体は悪くないが、これは入力テキストでこれが入るならいいけど、ナレッジにこれが入ると今後ナレッジとして他の投稿をしようとした時も仕事ができるがシゴデキと表現され、このナレッジを使用している、って読者がすぐに気づいてしまう

**181** 元メンヘラが実践して…　という表現　これ毎回投稿はこの人が投稿するわけではないのでターゲットやペルソナは固定されてていいが、投稿者が固定されるような表現は投稿の質を阻害する　183～186は最後のページに謎の関連「ナレッジ」ページがある

## ページ数と内容に関する考え方
ページ数が不足しているとかそういう概念は一旦置いといて　例えば1ページに結構優秀な紹介が詰まってるのならそれはそれでいい　※ページを分けて1ページ1個~２個の紹介でもいいが

## ナレッジデータベースとしての純粋性
これはナレッジのデータベースなので、内容に関係ないCTA　例　保存して　いいねして　その他の関連投稿　プロフィール　無料でプレゼント　タイトルだけのページ　が、ページごとにもコンテンツの中にも一切不要

## アプローチ方針
「修正」作業だと思わないでほしい　私のフィードバックを元に「理想の」ナレッジデータベースというものを作り上げて、それに合わせて全部を「理想形」にするというのアプローチがいいです　まずは私のフィードバックを正確に理想形として昇華する必要があります　ここに私とあなたでギャップが生まれると全部が間違った形になるからね

## 関連ドキュメント

### ページ構成詳細分析
**パス**: `/mnt/c/instagram-course/instagram-post-generator/思考プロセス①_ページ構成.md`

6つの完成ページ構成パターン（typeID001-emotion-empathy-list、typeID001-episode-parallel-intro、typeID002-ng-good-comparison-pattern、typeID002-parallel-introduction、typeID002-sequential-dependency、typeID004-tools-services-introduction）の詳細分析。

各構成の流れ、テンプレート要件、使用場面、共通パターンを包括的にまとめた。導入→メインコンテンツ→まとめの3段階構造、動的ページ対応、オプショナル要素の扱いなど、構造設計思想も明確化済み。

## Type003システム整備フィードバック（2025年7月）

### 初期問題の特定

**エラー分析への指示**: "なぜPageStructureMatcherが呼び出されてる？　なぜAIが稼働してる？"

**前任者への批判**: "あーわかったわ　普通に024に前任者がページストラクチャーを追加しないといけないのに追加してねえわ　マジ最悪"

**作業指示**: "これらに対して　適切にC:\instagram-course\instagram-post-generator\app\services\knowledgeBase\data\pageStructures\typeID003-company-detail-showcase.json C:\instagram-course\instagram-post-generator\app\services\knowledgeBase\data\pageStructures\typeID003-industry-infographic-analysis.json C:\instagram-course\instagram-post-generator\app\services\knowledgeBase\data\pageStructures\typeID003-industry-ranking-list.json　これを  "pageStructurePattern": フィールドを追加してここに設定して　K132を参考にするといいよ"

### 作業範囲の明確化

**指定ナレッジファイルの確認**: "007って私指定した？？？？？"

**正確な作業範囲の提示**: "指定されたのは以下の7つです：- K007: 人事インサイダー情報・業界知見 - K016: 企業実態情報 - K024: 大手企業採用情報 - K026: インターン企業TOP50 - K031: 残業多い職種ランキング - K036: 夏インターン企業18選 - K051: 休日多い仕事9選"

**作業継続の確認**: "はい"

**既存作業の無駄排除**: "いや別に既にあるやつをわざわざ追加せんでもいいがな"

### 問題解決と方向性決定

**P026マッピング修正指示**: "直せ"

**システム稼働確認**: "まあいいやとりあえず稼働したわ"

**現状確認の要求**: "それぞれどのページパターンが振り分けられてる？"

### K024とK026の分類に関する指摘

**024に関して**: "024に関してはランキングではなく一つ一つのディテールでは？"

**K026の方向性決定**: "でもディテールって感じでもないよね？　K026をランキング形式で表示されるように作り替えよう"

**作業指示の明確化**: "やり直してください"

### フォールバック問題の指摘

**システム動作への疑問**: "フォールバックが発生している？　本来ここが正しく機能してるのならPageStructureMatcherが発動するはずがないのだが？"

### ナレッジファイル構造問題の指摘

**生成結果への批判**: "導入しか生成されないですね"

### ランキング形式フォーマットの確定

K026作り替え完了後: "これがランキング形式で表示するためのKxxxのフォーマットになります　これを思考プロセスのページ構成に追記してください"

### 企業詳細形式フォーマットの確定

K024構造確認後: "ディテール版（024）のフォーマットも確定しましたよね？　これを追記しましょう"

### K007の誤分類指摘

Type003への不適切な分類に対して: "K007はなんでここで出てきた？　ハッキリ言ってK007は仕事が早い人ジャンルで合ってこれType003では全くないぞ？"

### フィードバック文書化の指示

**最終指示**: "もう少し前のもある？"

## テンプレート確定に関する方針（2025年7月29日）

### テンプレートの基本分類

次にテンプレートを確定する。テンプレートは４タイプある：
- メインコンテンツ用
- 導入・INDEX用  
- サマリー・まとめ用
- （4タイプ目については未言及）

### ページ構成の構造

これらの組み合わせがページ構成ということになる。

### 現状の課題認識

現ページ構成は投稿タイプ別になっているが、これはもう少し柔軟でもいいかと思っている。

## テンプレートの概念定義

### テンプレート①

**構成要素**:
- タイトル
- 画像
- ディスクリプション

**参考画像**: C:\instagram-course\instagram-post-generator\contents\2\S__16244744_0.jpg

**注意事項**: CTAは不要

**🔧 実装詳細**

  1. タイトル（中央配置）
     ↓
  2. 画像（中央配置、256x256px）
     ↓
  3. ディスクリプション（白背景ボックス内、中央配置）


  // 1. タイトル
  <h1 className="text-4xl font-bold text-gray-900">
    {cleanMarkdown(title)}
  </h1>

  // 2. 画像  
  <div className="w-64 h-64 relative bg-gray-50 rounded-lg">
    <Image src={imageSrc} alt={imageAlt} />
  </div>

  // 3. ディスクリプション
  <div className="bg-white rounded-lg p-6 shadow-sm">
    <p className="text-xl text-gray-700">
      {cleanMarkdown(description)}
    </p>
  </div>

**必要データ項目（detailedContent内）**:
```json
{
  "title": "string - メインタイトル",
  "description": "string - 説明文",
  "imageSrc": "string - 画像パス（オプション）",
  "imageAlt": "string - 画像alt属性（オプション）"
}
```

### テンプレート②

**レイアウト**: 上下構成

**構成要素**:
- タイトル
- 上部セクション
  - タイトル
  - 画像（オプショナル）
  - ボックスの中に description or list（どちらでも可能）
- 下部セクションボックス
  - タイトル
  - 画像（オプショナル）
  - ボックスの中に description or list（どちらでも可能）
- オプショナルでフッターdescription（基本はあまり登場しない）

**実装状況**:   
1. description or list 両対応実装
    - string → 段落表示
    - string[] → Lucide Reactのチェックアイコン付きリスト表示
2. 統一データ構造対応
  items: [
    {
      title: "セクションタイトル",
      description: string | string[], // ← 両対応
      imageSrc: "画像パス（オプション）"
    }
  ]
3. フッター説明文対応
    - footerDescription オプショナルフィールド追加

**必要データ項目（detailedContent内）**:
```json
{
  "items": [
    {
      "title": "string - セクションタイトル",
      "number": "number - 表示番号（オプション）",
      "description": "string | string[] - description(段落) or list(チェック付き)",
      "imageSrc": "string - 画像パス（オプション）",
      "imageAlt": "string - 画像alt属性（オプション）"
    }
  ],
  "footerDescription": "string - フッター説明文（オプション）"
}
```

### テンプレート③

**名称**: ランキング・Tierテンプレート

**実装状況**: 既存のC:\instagram-course\instagram-post-generator\app\components\templates\IndustryRankingTemplate.tsxでほぼ完成

**必要データ項目（detailedContent内）**:
```json
{
  "title": "string - メインタイトル",
  "subtitle": "string - サブタイトル（オプション）",
  "displayType": "string - ranking | tier",
  "items": [
    {
      "rank": "number - ランク番号",
      "name": "string - 項目・企業名",
      "primaryValue": "string | number - メイン数値・値",
      "secondaryValue": "string | number - サブ数値・値（オプション）",
      "description": "string - 説明文（オプション）",
      "category": "string - カテゴリ（オプション）"
    }
  ],
  "tiers": {
    "SSS": "RankingItem[] - SSSランクアイテム（オプション）",
    "SS": "RankingItem[] - SSランクアイテム",
    "S": "RankingItem[] - Sランクアイテム（オプション）",
    "A": "RankingItem[] - Aランクアイテム（オプション）"
  },
  "note": "string - 注意事項（オプション）",
  "source": "string - 出典情報（オプション）"
}
```

### テンプレート④

**名称**: アイテムボックステンプレート

**構成要素**:
- タイトル
- 画像
- description

**レイアウト**:
- 偶数：カラム
- 奇数：ピラミッドとカラム

**実装状況**: C:\instagram-course\instagram-post-generator\app\components\templates\MultipleItemsDisplayTemplate.tsxでほぼ完成

**必要データ項目（detailedContent内）**:
```json
{
  "title": "string - メインタイトル",
  "subtitle": "string - サブタイトル（オプション）",
  "items": [
    {
      "name": "string - アイテム名・タイトル",
      "description": "string - アイテム説明文",
      "imageSrc": "string - 画像パス（オプション）",
      "imageAlt": "string - 画像alt属性（オプション）"
    }
  ]
}
```

### テンプレート⑤

**名称**: 比較用テンプレート

**構成要素**:
- タイトル
- description（オプショナル）
- ボックス２カラム構成
  - 左：セクションname + description or list（共にOK）
  - 右：セクションname + description or list（共にOK）
- その下にボックス
  - セクションname（オプショナル）
  - description or list

**実装状況**
  - vs構造 - leftSection vs rightSection の汎用構造
  - NG GOOD - 左右セクション名を「NG例」「GOOD例」に設定可能
  - いい例 悪い例 - セクション名を「悪い例」「いい例」に設定可能
  - できる人 できない人 - セクション名を「できない人」「できる人」に設定可能

**必要データ項目（detailedContent内）**:
```json
{
  "title": "string - メインタイトル",
  "description": "string - 説明文（オプション）",
  "leftSection": {
    "name": "string - 左セクション名（NG例・できない人等）",
    "content": "string | string[] - description(段落) or list(チェック付き)"
  },
  "rightSection": {
    "name": "string - 右セクション名（GOOD例・できる人等）",
    "content": "string | string[] - description(段落) or list(チェック付き)"
  },
  "bottomSection": {
    "name": "string - 下部セクション名（オプション）",
    "content": "string | string[] - description(段落) or list(チェック付き)"
  }
}
```

### テンプレート⑥

**名称**: １つ企業を詳しく紹介するためのテンプレート

**実装状況**: C:\instagram-course\instagram-post-generator\app\components\templates\CompanyDetailTemplate.tsxが該当

**必要データ項目（detailedContent内）**:
```json
{
  "companyName": "string - 企業名",
  "catchphrase": "string - キャッチフレーズ（オプション）",
  "logo": "string - 企業ロゴパス（オプション）",
  "features": {
    "industry": "string - 業界",
    "salary": "string - 年収情報（オプション）",
    "holidays": "string - 休日数（オプション）",
    "overtime": "string - 残業情報（オプション）",
    "employees": "string - 従業員数（オプション）"
  },
  "details": {
    "overview": "string - 企業概要",
    "recruitment": "string[] - 募集職種配列",
    "hiringCount": "string - 採用予定数（オプション）",
    "benefits": "string[] - 福利厚生配列（オプション）"
  },
  "selectionProcess": "string[] - 選考フロー配列（オプション）",
  "highlightMessage": "string - ハイライトメッセージ（オプション）"
}
```

### テンプレート⑦

**構成要素**:
- タイトル
- アイテムname + description
- アイテムname + description
- 動的に最大5つまで

**参考画像**: contents/188のページ4

**必要データ項目（detailedContent内）**:
```json
{
  "title": "string - メインタイトル",
  "items": [
    {
      "name": "string - アイテム名",
      "description": "string - アイテム説明文"
    }
  ]
}
```

### テンプレート⑧

**構成要素**:
- タイトル
- ボックス：セクションアイテムname + description or list（ともにOK）
- ボックスの下に：テキスト（オプショナル）
- ボックス：セクションアイテムname + description or list（ともにOK）
- ボックスの下に：テキスト（オプショナル）
- その下に２カラム
  - 左：セクションname（オプショナル）+ description or list
  - 右：画像（キャラクター）

**参考画像**: contents/188のページ7
**対応キャラクター**: 投稿タイプとターゲットで動的に判断する（basic_introと同じ概念）

**必要データ項目（detailedContent内）**:
```json
{
  "title": "string - メインタイトル",
  "sections": [
    {
      "name": "string - セクション名",
      "content": "string | string[] - description(段落) or list(チェック付き)",
      "image": "string - セクション画像パス（オプション）",
      "footerText": "string - セクション下テキスト（オプション）"
    }
  ],
  "characterImage": "string - キャラクター画像パス（オプション）",
  "characterPosition": "string - left | right（オプション）",
  "bottomSectionName": "string - 下部セクション名（オプション）",
  "bottomSectionContent": "string | string[] - 下部セクション内容（オプション）"
}
```
### テンプレート⑨

**構成要素**:
- タイトル
- ボックス：セクションアイテムname + description or list（共にOK）
- このボックスを動的に最大4つ

**必要データ項目（detailedContent内）**:
```json
{
  "title": "string - メインタイトル",
  "boxes": [
    {
      "name": "string - セクション名",
      "content": "string | string[] - description(段落) or list(チェック付き)"
    }
  ]
}
```

### テンプレート⑩

**構成要素**:
- タイトル
- ２カラム
  - 左：画像
  - 右：ボックスで重要ポイントを一言
- ２カラムの下に：テキスト（オプショナル）
- その下に：ボックスでセクションアイテムname + description or list（ともにOK）

**参考画像**: C:\instagram-course\instagram-post-generator\contents\190\S__16327380_0.jpg

**必要データ項目（detailedContent内）**:
```json
{
  "title": "string - メインタイトル",
  "mainImage": "string - メイン画像パス（オプション）",
  "importantPoint": "string - 重要ポイント一言",
  "description": "string - 2カラム下のテキスト（オプション）",
  "bottomSection": {
    "name": "string - セクション名（オプション）",
    "content": "string | string[] - description(段落) or list(チェック付き)"
  }
}
```

## ページ構成パターンの構成方針（2025年7月29日）

### 基本原則

**構成方針**: メインコンテンツテンプレートの数＝ページ構成パターンになる予定

### 最適化プロセス

1. **テンプレート判断**: どのテンプレートで表現するのが最適か（主に情報量）を判断
2. **ページ構成当てはめ**: そのテンプレートをメインコンテンツセクションに使用しているページ構成を当てはめ
3. **Kxxx最適化**: Kxxxの構造を欠損させずにそのテンプレートに最適化

## Kxxxフィールド削除・整理指針（2025年7月29日）

### 削除対象フィールド

#### **完全未使用フィールド**
- **warnings**: システム内で参照されていない完全未使用フィールド → 削除

#### **レガシーフィールド（旧仕様の残存）**
- **empathyHooks**: K001, K180のみに残存 → 削除
- **empathyContent**: K001, K180のみに残存 → 削除
- **empathyClimax**: K001, K180のみに残存 → 削除
- **communityValidation**: K001, K180のみに残存 → 削除
- **hopeTransition**: K001, K180のみに残存 → 削除

#### **不要フィールド**
- **targetReason**: 不要 → 削除
- **hashTag**: 不要 → 削除

### 混入禁止フィールド

以下のフィールドはナレッジデータベースとしての純粋性を阻害するため混入禁止：
- **cta**: Call-to-Action要素
- **offerTitle**: オファータイトル
- **limitedOffer**: 限定オファー

### detailedContent内フィールドの取り扱い

**基本方針**: detailedContent内のフィールドは削除しない
- **理由**: detailedContent内の全てはそのままプロンプトに送られるため
- **構造**: detailedContentのフォーマットはテンプレートごとに異なる
- **対応テンプレート**: 
  - メインコンテンツ用テンプレート10種類
  - 導入・INDEX用テンプレート
  - サマリー・まとめ用テンプレート

### 整理の優先順位

1. **即座削除**: warnings, hashTag, targetReason
2. **段階削除**: empathy系5フィールド（K001, K180から）
3. **混入監視**: cta, offerTitle, limitedOffer（新規作成時に注意）
4. **構造保持**: detailedContent内フィールドは維持