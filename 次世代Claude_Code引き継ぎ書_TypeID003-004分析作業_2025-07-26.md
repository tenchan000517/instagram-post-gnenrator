# 次世代Claude Code引き継ぎ書 - TypeID/ターゲットマッピング修正作業

## 🚨 緊急修正事項

### **現在の問題状況**
- **前任者の適当マッピング**により、relationファイルのターゲット振り分けが破綻
- **K002問題**: K002(postType="002")がT002(TypeID=001)にマップされ、不整合発生
- **knowledgeId推測ロジック**をpostType使用に修正済み(KnowledgeBasedContentGenerator.ts:116)

### **完了済み作業**
1. ✅ **KnowledgeBasedContentGenerator修正完了**
   - knowledgeId推測 → postType使用に変更
   - 修正箇所: `const typeId = knowledgeData.postType || '002'`

2. ✅ **実存ナレッジ104個のpostType分布調査完了**
   - TypeID 001: 15個 (15.5%)
   - TypeID 002: 12個 (12.4%) 
   - TypeID 003: 36個 (37.1%)
   - TypeID 004: 34個 (35.1%)
   - postType未設定: 7個 (K059, K060, K086-K090)

## 🎯 新ターゲット定義（確定版）

### **TypeID=001: キャリアの悩み解決法 (4ターゲット)**
- **T002**: 仕事・キャリアに悩んでいる「女性」(25-40歳)
- **T003**: 仕事・キャリアに悩んでいる「男性」(25-40歳)
- **T005**: 転職をしようか悩んでいる「女性」(25-40歳)
- **T006**: 転職をしようか悩んでいる「男性」(25-40歳)

### **TypeID=002: スキルアップガイド (6ターゲット)**
- **T007**: 対策方法やノウハウによって就活で差をつけたい学生
- **T008**: 起業を考えている学生
- **T009**: 新しいスキルを身に着けたい「女性」(25-40歳)
- **T010**: 新しいスキルを身に着けたい「男性」(25-40歳)
- **T011**: 起業を考えている「女性」(25-40歳)
- **T012**: 起業を考えている「男性」(25-40歳)

### **TypeID=003: 業界・企業情報まとめ (6ターゲット)**
- **T013**: 企業研究・業界研究をしている学生
- **T014**: 転職を探している人（男女共通・25-40歳）
- **T015**: 起業に関する情報を知りたい人
- **T016**: 最新情報を知りたい人
- **T017**: 有益情報を知りたい人
- **T018**: 便利なツールやサイトを知りたい人

### **TypeID=004: 効率アップテクニック (6ターゲット)**
- **T019**: AIやツールで就活を効率化したい学生
- **T020**: AIやツールを使って日々の仕事や生活を効率化させたい女性(25-40歳)
- **T021**: AIやツールを使って日々の仕事や生活を効率化させたい男性(25-40歳)
- **T022**: 就活に使える「プロンプト」を知りたい学生
- **T023**: 仕事・生活に使える「プロンプト」を知りたい「女性」(25-40歳)
- **T024**: 仕事・生活に使える「プロンプト」を知りたい男性(25-40歳)

## 🔧 必要な修正作業

### **1. ui-names.json の更新**
```json
{
  "types": {
    "001": "キャリアの悩み解決法",
    "002": "スキルアップガイド", 
    "003": "業界・企業情報まとめ",
    "004": "効率アップテクニック"
  },
  "targets": {
    "T002": "仕事・キャリアに悩んでいる「女性」",
    "T003": "仕事・キャリアに悩んでいる「男性」",
    "T005": "転職をしようか悩んでいる「女性」",
    "T006": "転職をしようか悩んでいる「男性」",
    "T007": "対策方法やノウハウによって就活で差をつけたい学生",
    "T008": "起業を考えている学生",
    "T009": "新しいスキルを身に着けたい「女性」",
    "T010": "新しいスキルを身に着けたい「男性」",
    "T011": "起業を考えている「女性」",
    "T012": "起業を考えている「男性」",
    "T013": "企業研究・業界研究をしている学生",
    "T014": "転職を探している人（男女共通）",
    "T015": "起業に関する情報を知りたい人",
    "T016": "最新情報を知りたい人",
    "T017": "有益情報を知りたい人",
    "T018": "便利なツールやサイトを知りたい人",
    "T019": "AIやツールで就活を効率化したい学生",
    "T020": "AIやツールを使って日々の仕事や生活を効率化させたい女性",
    "T021": "AIやツールを使って日々の仕事や生活を効率化させたい男性",
    "T022": "就活に使える「プロンプト」を知りたい学生",
    "T023": "仕事・生活に使える「プロンプト」を知りたい「女性」",
    "T024": "仕事・生活に使える「プロンプト」を知りたい男性"
  }
}
```

### **2. type-target-persona-relations.json の再構築**

**基本方針:**
- 104個の実存ナレッジのpostTypeを基準とする
- 各ナレッジの内容とターゲット定義の適合性で判断
- **バランス重視ではなく、内容適合性を最優先**

**TypeID別配分:**
```json
{
  "typeToTargets": {
    "001": ["T002", "T003", "T005", "T006"],
    "002": ["T007", "T008", "T009", "T010", "T011", "T012"],
    "003": ["T013", "T014", "T015", "T016", "T017", "T018"],
    "004": ["T019", "T020", "T021", "T022", "T023", "T024"]
  },
  "targetToPersonas": {
    // 15個のTypeID=001ナレッジを4ターゲットに適切配分
    // 12個のTypeID=002ナレッジを6ターゲットに適切配分
    // 36個のTypeID=003ナレッジを6ターゲットに適切配分
    // 34個のTypeID=004ナレッジを6ターゲットに適切配分
  },
  "personaToKnowledge": {
    // 各P###を対応するK###にマップ
    // 存在しないペルソナID（P130-P174等）は削除
    // 実存する104個のナレッジのみ使用
  }
}
```

### **3. postType未設定ナレッジの対応**
- K059, K060, K086-K090 の7個のpostType設定が必要
- 内容分析により適切なTypeIDを判定・設定

## 🎯 K002の正しいマッピング例

**K002**: 「女性が将来への不安、キャリア継続の不安...」
- **現在**: K002.postType="002" (間違い)
- **正しい**: K002.postType="001" → T002「仕事・キャリアに悩んでいる女性」

## 📋 優先作業順序

1. **ui-names.json更新** (即座実行可能)
2. **postType未設定7ナレッジの内容分析・設定**
3. **全104ナレッジの内容とターゲット適合性分析**
4. **新relationファイル作成**
5. **動作検証・テスト**

## 🚨 重要な設計原則

**「内容適合性 > バランス」**
- 各ナレッジの problemDescription + solutionContent を分析
- 最適なターゲット読者層にマッピング
- 機械的な均等配分は絶対に行わない

---

**引き継ぎ者**: 次世代Claude Code  
**前任者**: Claude Code (2025-07-26)  
**緊急度**: 最高 - システム基盤の整合性に関わる重要修正  
**期待完了時間**: ui-names.json更新は即座、全体完了は2-3時間