# コンテンツ分析フォーマット - マスタードキュメント

## 📋 概要

このドキュメントは、ナレッジベース内のコンテンツ分析において使用する正しいフォーマットを定義します。テンプレート構造と完全に一致する形式でコンテンツを記載することで、システムの動的生成機能が正常に動作します。

## 🎯 基本原則

### テンプレート構造との完全一致
- 静的JSONの`templateStructure`で定義されたフィールドのみを使用
- 不要なCTA要素（`savePrompt`, `cta`, `finalPageOffer`等）は含めない
- プロンプト生成時にテンプレート構造が正しく参照される

### セクション分類の明確化
- `"section": "intro"`: 導入ページ
- `"section": "mainContent"`: 動的生成対象のメインコンテンツ
- `"section": "summary"`: まとめページ（該当する場合）

## 📝 TypeID=001: エピソード並列紹介型の正しいフォーマット

### 静的JSON構造（参照用）
```json
{
  "pageStructureId": "typeID001-episode-parallel-intro",
  "pages": [
    {
      "pageNumber": 1,
      "templateId": "failure_story_intro",
      "templateStructure": {
        "question": "string",
        "promise": "string"
      }
    },
    {
      "pageNumber": "dynamic",
      "templateId": "failure_episode",
      "templateStructure": {
        "episodeNumber": "string",
        "title": "string",
        "logo": "string",
        "description": "string",
        "failure": "string",
        "conclusion": "string",
        "question": "string"
      }
    }
  ]
}
```

### ナレッジファイルの正しい記載例（K115）

#### Page 1: failure_story_intro
```json
"page1": {
  "role": "導入・問題提起",
  "layout": "質問形式 + 自己紹介 + 約束",
  "section": "intro",
  "content": {
    "question": "「スキル0でもOK！」「スキマ時間に稼げる！」って複業、実際どうなの？",
    "promise": "フリーランス6年目に至るまでのわたしのリアル失敗談をお話しします（笑）"
  }
}
```

**重要**: `finalPageOffer`と`cta`は削除済み

#### Page 2-7: failure_episode（mainContent）
```json
"page2": {
  "role": "episode 01 - ポイ活",
  "layout": "エピソード形式",
  "section": "mainContent",
  "content": {
    "episodeNumber": "01",
    "title": "ポイ活",
    "logo": "moppy",
    "description": "「アンケートに答するだけで100pt」の手軽さに惹かれて始めたけど...",
    "failure": "1件5分→10件で50分。1時間近くかけて貯まるのはたった500ptと気づいて我に帰りました...。",
    "conclusion": "楽して稼ごうつもりが思った以上に時間を浪費。「お得」より「時間の使い方」の方が大事だった..."
  }
}
```

**重要**: `savePrompt`は削除済み

#### オプショナルフィールド: question
```json
"page3": {
  "content": {
    "episodeNumber": "02",
    "title": "ブログ", 
    "logo": "WordPress",
    "description": "「ブログで稼げた」という主婦の記事でわたしでもいけるかも！と思って始めたけど...",
    "failure": "3ヶ月頑張って毎日更新しても見てくれたのはたったの100人😭 もちろん収益ゼロで心くじけた...。",
    "conclusion": "自己満ブログじゃ読まれない。読者が大切と痛感。この失敗は今に活かしています！",
    "question": "こんな失敗みんなも経験ある？"
  }
}
```

## ❌ 削除すべき不要な要素

### CTA関連要素（全て削除対象）
- `savePrompt`: 「同じ失敗をしないように保存してね！」
- `cta`: 「気になったら保存してね!」
- `finalPageOffer`: 「最後のページで、わたしが紆余曲折してたどり着いた複業の始め方ガイドをプレゼントするよ！」

### 理由
1. **テンプレート構造に含まれていない**
2. **プロンプト生成時に不要なデータとして扱われる**
3. **純粋なコンテンツに集中するため**

## ✅ 必須フィールドと構造

### failure_story_intro（導入ページ）
- ✅ `question`: 問題提起の質問
- ✅ `promise`: 体験談の約束・予告

### failure_episode（エピソードページ）
- ✅ `episodeNumber`: エピソード番号（"01", "02"等）
- ✅ `title`: エピソードのタイトル
- ✅ `logo`: 関連サービス・ツールのロゴ名
- ✅ `description`: エピソードの導入説明
- ✅ `failure`: 失敗の具体的な内容
- ✅ `conclusion`: 失敗から得た結論・学び
- ⚪ `question`: オプショナル - 読者への問いかけ

## 🔧 動作確認方法

1. **静的JSON確認**: `templateStructure`で定義されたフィールドを確認
2. **ナレッジファイル修正**: 静的JSONの構造に完全一致させる
3. **テスト実行**: K115 Page 1でテンプレート構造が正しく認識されることを確認
4. **プロンプト確認**: 生成されるプロンプトに不要な要素が含まれていないことを確認

## 📄 サマリーページの扱い（該当する場合）

### 基本原則
TypeID=001のエピソード並列紹介型でサマリーページが存在する場合の正しいフォーマット：

#### 静的JSON構造（拡張版）
```json
{
  "pageStructureId": "typeID001-episode-parallel-intro-summary",
  "pages": [
    {
      "pageNumber": 1,
      "templateId": "failure_story_intro",
      "templateStructure": { /* intro構造 */ }
    },
    {
      "pageNumber": "dynamic",
      "templateId": "failure_episode", 
      "templateStructure": { /* episode構造 */ }
    },
    {
      "pageNumber": "last",
      "templateId": "episode_summary",
      "templateStructure": {
        "summaryTitle": "string",
        "keyLearnings": "string[]",
        "finalMessage": "string"
      }
    }
  ]
}
```

#### ナレッジファイルでの記載例
```json
"page8": {
  "role": "全体のまとめ・総括",
  "layout": "学びの整理 + 励ましメッセージ",
  "section": "summary",
  "content": {
    "summaryTitle": "6つの副業失敗から学んだこと",
    "keyLearnings": [
      "時間対効果を常に意識する",
      "読者視点でコンテンツを作る", 
      "収益性と情熱のバランスを取る",
      "スキルアップに時間を投資する",
      "リスク管理を怠らない",
      "市場状況を見極める"
    ],
    "finalMessage": "失敗は成功への道筋。あなたも自分に合った副業を見つけられます。"
  }
}
```

### 除外すべき要素（サマリーページでも同様）
- ❌ `profileIntroduction`: プロフィール紹介
- ❌ `ctaMessage`: 行動促進メッセージ
- ❌ `relatedPosts`: 他の投稿紹介
- ❌ `followPrompt`: フォロー促進
- ❌ `offerDetails`: 無料プレゼント詳細

### サマリーページの核心要素のみ
- ✅ `summaryTitle`: まとめのタイトル
- ✅ `keyLearnings`: 重要な学びのリスト
- ✅ `finalMessage`: 最終的な励まし・メッセージ

## 📚 今後の拡張

他の投稿タイプ（TypeID=002, 003, 004）についても同様の分析フォーマットを定義し、13パターンの静的JSON全てに対応する正しいコンテンツ記載方法を確立する。各パターンでもCTA、プロフィール紹介、他投稿紹介は一律除外し、純粋なコンテンツ要素のみに焦点を当てる。

---

**作成日**: 2025-07-25  
**重要度**: 最高 - コンテンツ分析の品質基準  
**適用対象**: K115（動作確認済み）  
**参照**: ページ構成動的生成システム設計理論_マスタードキュメント.md