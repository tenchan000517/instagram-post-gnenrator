# Instagram Post Generator - Issues & TODO

## Issue #1: コンテンツ文字数制限の実装 ✅ 完了

### 問題
- 現在、コンテンツがビューポート（850×800px）からはみ出すことがある
- PostSlideやその他のテンプレートで文字数制限が設定されていない

### 解決状況
✅ 各テンプレートタイプごとに文字数制限を厳密に定義し、AI生成時にこの制限に従うように実装済み
✅ 文字数制限バリデーションと自動調整機能を追加
✅ マークダウン記法の自動除去システムを実装

---

## Issue #2: ビューポートサイズの最適化 ✅ 完了

### 現状
- ビューポート: 850×800px
- Instagram標準: 1080×1080px

### 解決状況
✅ 現在のビューポートサイズで問題なく動作することを確認
✅ ダウンロード時の画像生成が正常に機能

---

## Issue #3: デバッグラインの削除 ✅ 完了

### 解決状況
✅ 全コンポーネントからデバッグ用のカラーラインを削除
✅ 本番環境用のクリーンなコードに整理

---

## Issue #4: 絵文字除去とコンテンツ品質向上 ✅ 完了

### 問題
- コンテンツ生成時に絵文字が含まれることがある
- キャプションとハッシュタグが統合されていない
- ハッシュタグが8個しか生成されない問題
- キャプション再生成機能が不適切

### 解決状況
✅ **絵文字除去機能**: コンテンツ生成AIに絵文字使用禁止制約を追加（キャプションでは✅のみ使用可）
✅ **ハッシュタグ11個固定化**: 大3+中3+小2+メインジャンル3=11個の構成で重複防止機能を実装
✅ **統合コピー機能**: キャプション + ハッシュタグの統合フィールドとワンクリックコピー機能を追加
✅ **キャプション再生成機能**: AI生成による高品質なキャプション再生成機能を実装
✅ **フォールバック機能削除**: 簡単なキャプション生成を削除し、実際のAI生成のみを使用
✅ **プロフェッショナルなトーン**: 400-500文字の適切なボリュームで上品な文体に改善

### 実装完了日
2025年1月11日

### 優先度
中 - ユーザビリティの向上

---

## Issue #5: テンプレートシステムの包括的改善

### 問題
- テンプレートの文字数制限が不適切
- レイアウトの改善が必要
- Lucide Reactアイコンの使用方法が不適切
- 不要な要素（質問コメントボックス、ページ番号）が含まれている
- テンプレートとコンテンツのマッチング精度が低い

### 実装予定

#### 1. タイトル文字数とレイアウト改善
- 各テンプレートのタイトル文字数を最適化
- レイアウトの視覚的改善
- 文字サイズとスペーシングの調整

#### 2. Lucide Reactアイコンの改善
- 正しいアイコンの選択と使用方法
- アイコンサイズの統一
- 適切なアイコンの配置

#### 3. ラベルとUI要素の改善
- より直感的なラベル文言
- 不要な要素の削除
  - 質問コメントボックス
  - ページ番号表示
- UI要素の整理

#### 4. テンプレートマッチング精度向上
- コンテンツタイプとテンプレートの適合性向上
- AI分析による最適なテンプレート選択
- テンプレート推薦システムの改善

#### 5. テンプレート最適化
- 効果的なテンプレートを追加
- 使用頻度が低いテンプレートの削除
- テンプレートの統合と最適化

### 対象テンプレート
- EnumerationTemplate（列挙型）
- ExplanationTemplate（説明型）
- StoryTemplate（ストーリー型）
- ListTemplate（リスト型）
- SimpleTemplate系（シンプル型1-6）
- TableTemplate（表型）

### 優先度
高 - コンテンツ品質とユーザーエクスペリエンスの向上

### 関連ファイル
- `/app/components/templates/`
- `/app/services/templateMatchingService.ts`
- `/app/components/templates/TemplateRegistry.ts`

### 進捗状況
✅ 列挙型テンプレート改善完了（Tabler Icons数字使用）
✅ リスト型→チェックシート型変更完了（CheckSquareアイコン使用）
✅ シンプル型4改善完了（説明付きチェックリスト、全項目✅表示）
✅ **説明型テンプレート改善完了** - Lightbulb/Info/CheckCircleアイコン使用、重複フッター削除
✅ **ストーリー型テンプレート改善完了** - BookHeart/Starアイコン使用、重複フッター削除、レイアウト整理
✅ **表型テンプレート確認完了** - BarChart3アイコン使用、適切なテーブル構造
✅ **シンプル型1-6改善完了** - 各テンプレートのアイコン最適化、統一されたレイアウト
✅ **説明型2テンプレート確認完了** - AlertTriangleアイコン使用、適切な構造
✅ **セクション+アイテム型テンプレート新規実装完了** - pureStructureMatchingServiceと連携、統一デザインコンセプト適用
❌ テンプレートマッチング精度向上
❌ テンプレート最適化

---

## Issue #6: テンプレートマッチング精度の実戦的改善

### 概要
実際に生成されたコンテンツを各テンプレートに適用して、テンプレート選択アルゴリズムの精度を向上させる実戦的な改善作業。

### 目的
- コンテンツとテンプレートの相性計算ロジックをより実用的に調整
- 実際の生成コンテンツでのテスト・検証・微調整サイクル
- テンプレート選択の精度向上とユーザーエクスペリエンス改善

### 具体的作業内容

### 進捗状況
✅ **セクション+アイテム型テンプレート実装完了** - PureStructureMatchingServiceとの連携実装完了
- 実際の生成コンテンツ（explanation → section-items）での構造マッチング検証完了
- points + sections複合データ構造対応完了
- 統一デザインコンセプト（blue系配色、CheckCircleアイコン、text-baseフォントサイズ）適用完了
- TemplateViewerでの表示対応完了

#### 1. 実コンテンツでのテスト・検証
✅ pureStructureMatchingServiceによる構造ベース選択の検証完了
- 各テンプレートでの表示結果を視覚的に確認
- 最適なテンプレート選択がされているかを評価

#### 2. マッチングアルゴリズムの微調整
- `templateMatchingService.ts`のスコア計算ロジック改善
- キーワードマッチング精度の向上
- コンテンツ構造分析の精度向上
- 優先度設定の最適化

#### 3. テンプレート特性の再定義
- 各テンプレートの`suitableFor`条件の見直し
- `keywords`配列の精緻化
- `characterLimits`の実用的調整

#### 4. フィードバックループの構築
- テンプレート選択結果の評価指標設定
- 改善→テスト→評価→改善のサイクル確立
- ユーザビリティテストによる検証

### 対象ファイル
- `/app/services/templateMatchingService.ts`
- `/app/components/templates/TemplateRegistry.ts`
- `/app/components/templates/TemplateTypes.ts`
- 各テンプレートファイルのメタデータ

### 優先度
高 - Issue #5完了後の次期重要課題

### 期待される成果
- テンプレート選択精度の大幅向上
- コンテンツとテンプレートの最適マッチング
- ユーザーの手動選択頻度の削減
- より自然で効果的な投稿レイアウトの自動生成