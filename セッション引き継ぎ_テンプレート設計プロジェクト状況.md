# セッション引き継ぎ - テンプレート設計プロジェクト状況

## 📋 プロジェクト概要

**プロジェクト名**: Instagram投稿生成システム - ページ構成・テンプレート設計  
**最終更新**: 2025-07-25  
**セッション状況**: レイアウトパターン分析の直前段階  
**緊急度**: 高 - 100点マッチングシステムの基盤設計

---

## 🎯 プロジェクトの最終目標

### **目標**
各Kxxx.jsonの`detailedContent`に`section`と`template`フィールドを追加し、完璧なテンプレートマッチングシステムを構築

### **100点ルール（重要な設計思想）**
- **structureScore = 1.0** → 完璧なマッチ → 適切なテンプレート存在 ✅
- **structureScore < 1.0** → 部分的マッチ → 専用テンプレートが不足 ❌
- **妥協は品質劣化** → 100点未満は全て改善対象

---

## 📚 重要な概念と定義

### **1. ページ構成 vs テンプレートの分離**
- **ページ構成**: セクションの有無組み合わせ（構造的な枠組み）
- **テンプレート**: 各セクション内の表現方法・要素構成（具体的な表現パターン）

### **2. セクション分割の唯一の基準**
**「テンプレートが変わる = セクションが分かれる」**

#### **具体例**
```
K027の場合:
Page 2: 問題共感テンプレート → セクション1
Page 3: 解決導入テンプレート → セクション2
Page 4-7: Q&Aテンプレート → セクション3（同一テンプレートなので1セクション）
Page 8: 実践Tipsテンプレート → セクション4
```

### **3. テンプレート設計の基本構造**
**テンプレート = レイアウト構造 × カラム内容 × 要素バリエーション**

#### **共通要素（分析対象外）**
- ページヘッダー（ページインジケータ）
- 基本タイトル構造
- 装飾要素（キャラクター、背景色、フォント等）

#### **分析対象要素**
1. **レイアウト構造**: どのパターンでページが分割されているか
2. **カラム内容**: 各カラム/セクションに何が配置されているか
3. **情報構造**: 文章量、配置位置、階層関係

---

## 🎨 レイアウトパターン理論フレームワーク

### **全レイアウトパターン（最大10パターン）**

| No | パターンID | パターン名 | 構造 | 高さ比率 |
|----|-----------|-----------|------|----------|
| 1-1 | layout_1col_3div | 縦3分割型 | 上/中/下 | 1:1:1 |
| 1-2 | layout_1col_unified | 統合型 | 全面 | 1 |
| 2-1 | layout_2col_leftright | 左右分割型 | 左/右 | 全高 |
| 2-2-1 | layout_2col_updown_11 | 上下均等型 | 上/下 | 1:1 |
| 2-2-2 | layout_2col_updown_21 | 上部優位型 | 上/下 | 2:1 |
| 2-2-3 | layout_2col_updown_12 | 下部優位型 | 上/下 | 1:2 |
| 3-1-1 | layout_complex_up1_down2_21 | 上統合＋下2カラム(上優位) | 上統合/(下左/下右) | 2:1 |
| 3-1-2 | layout_complex_up1_down2_12 | 上統合＋下2カラム(下優位) | 上統合/(下左/下右) | 1:2 |
| 3-2-1 | layout_complex_up2_down1_21 | 上2カラム＋下統合(上優位) | (上左/上右)/下統合 | 2:1 |
| 3-2-2 | layout_complex_up2_down1_12 | 上2カラム＋下統合(下優位) | (上左/上右)/下統合 | 1:2 |

### **分析方針**
- **理論フレームワーク**: 最大10パターンの枠組み設定
- **実用性重視**: 実際に使用されているパターンのみ採用
- **自然淘汰**: Instagram画面制約で5-7パターンに収束予想

---

## 📊 これまでの作業進捗

### **✅ 完了した作業**

1. **概念整理完了**
   - ページ構成とテンプレートの分離概念確立
   - セクション分割基準の明確化
   - レイアウト理論フレームワーク完成

2. **ドキュメント作成完了**
   - `投稿タイプ別Problem-Solution構造分析.md` (基礎分析)
   - `投稿タイプ別ページ構成パターンリスト.md` (16パターンリスト)
   - `ページ構成・テンプレート設計方針_最終版.md` (設計方針)
   - `Kxxx_セクションマッピング.md` (実装仕様書)

3. **実装方針決定**
   - Kxxx.jsonの各ページに`section`と`template`フィールド追加
   - テンプレート命名規則: `{レイアウト}_{内容種別}_{バリエーション}`

### **⚠️ 重要な発見・決定事項**

#### **投稿タイプの理解**
- **TypeID=001**: 共感・感情誘導型 (17投稿, 17.0%)
- **TypeID=002**: 教育・学習特化型 (34投稿, 34.0%) ★最多
- **TypeID=003**: 情報提供・データ型 (28投稿, 28.0%)
- **TypeID=004**: 効率・実用特化型 (21投稿, 21.0%)

#### **テンプレート構造の統合**
- **順序重要型**: STEP型・時系列ストーリー型（同じテンプレート構造）
- **並列型**: 並列紹介・Q&A型（同じテンプレート構造）

#### **仮説（検証必要）**
- 各投稿タイプにつき2-3程度のテンプレート
- 投稿タイプ横断で共通テンプレートが多数存在
- 最終的に10-15個程度の核となるテンプレートで全投稿をカバー可能

---

## 🚀 次に行うべき作業（最重要）

### **Phase 1: 手動分析（代表例パターン発見）**

#### **分析対象（12個の代表例）**
- **TypeID=001**: K006, K027, K030, K032
- **TypeID=002**: K002, K040, K005  
- **TypeID=003**: K004, K025, K024
- **TypeID=004**: K113, K104

#### **分析手順**
1. **各Kxxx.jsonを読み込み**
2. **`layout`フィールドからレイアウト構造を判定**
   ```json
   "layout": "機能説明 + 実例画像 + 効果説明"
   ```
   ↓ 「A + B + C」= 縦3分割（layout_1col_3div）

3. **`content`フィールドから各カラムの内容を特定**
   ```json
   "content": {
     "featureNumber": "1",     // ← 上部カラム内容
     "description": "...",     // ← 中部カラム内容  
     "effect": "..."          // ← 下部カラム内容
   }
   ```

4. **文章量・要素タイプを分析**
   - 短文(1-2行), 中文(3-5行), 長文(段落)
   - リスト型, 画像型, 対比型等

5. **パターン仮説構築**

#### **成功判断基準**
「これで全体をカバーできそう！」と確信できたらPhase 2へ

### **Phase 2: 半自動分析（全体適用）**
1. 全104個のlayout文字列抽出・分類
2. content要素の自動カウント・分析  
3. Phase 1パターンへの自動振り分け
4. 例外・新パターンの検出

### **Phase 3: 最終実装**
1. 完全なsectionTemplateMapping作成
2. 一括スクリプトでKxxx.json更新
3. テンプレートパターン定義完成

---

## 🔍 分析に使用するデータ構造

### **Kxxx.jsonの重要フィールド**
```json
{
  "knowledgeId": "K113",
  "pageCount": 10,
  "detailedContent": {
    "page2": {
      "role": "導入・概要ページ",
      "layout": "世界地図背景 + 説明文",
      "content": {
        "subtitle": "...",
        "introText": "...",
        "description": "..."
      }
    }
  }
}
```

### **目標の拡張構造**
```json
"page2": {
  "section": "intro",                    // ← 追加
  "template": "layout_1col_unified_basic_intro", // ← 追加  
  "role": "導入・概要ページ",
  "layout": "世界地図背景 + 説明文",
  "content": { ... }
}
```

---

## 📁 関連ドキュメント

### **必読ドキュメント**
1. `投稿タイプ別Problem-Solution構造分析.md` - 基礎理論と16パターン分析
2. `ページ構成・テンプレート設計方針_最終版.md` - 設計方針とPhase計画
3. `Kxxx_セクションマッピング.md` - 実装仕様書とレイアウトパターン完全版

### **参考データ**
- `app/data/knowledgeBase/knowledge/K*.json` - 104個の分析対象ファイル
- `knowledgeId-postType-マップ.md` - TypeID分類マップ

---

## 🎯 重要な設計思想（忘れてはいけない）

### **1. シンプルさの追求**
「テンプレートが変わる = セクションが分かれる」の単純な基準

### **2. 実装の現実性**
既存システムとの整合性を重視した段階的実装

### **3. 100点マッチング**
妥協のない完璧なテンプレートマッチングシステムの構築

### **4. 装飾要素の除外**
デザイン統一性のため、装飾的要素はテンプレート分類から除外

### **5. 客観的分析**
「無理な振り分け禁止」- 実際に存在するパターンのみを抽出

---

## ⚡ 緊急時の再開手順

### **1. 環境確認**
- 作業ディレクトリ: `/mnt/c/instagram-course/instagram-post-generator`
- 関連ドキュメントの存在確認

### **2. 必読ドキュメント（順番重要）**
**以下のドキュメントを必ず順番通りに読み込んでください：**

1. **このドキュメント**: `セッション引き継ぎ_テンプレート設計プロジェクト状況.md`
2. **基礎理論**: `/mnt/c/instagram-course/instagram-post-generator/投稿タイプ別Problem-Solution構造分析.md`
3. **実装仕様**: `/mnt/c/instagram-course/instagram-post-generator/Kxxx_セクションマッピング.md`

**重要**: 上記3つのドキュメントを読み込まずに作業を開始しないでください。

### **4. 作業再開**
Phase 1の手動分析から再開：
```bash
# 代表例ファイルの確認
ls app/data/knowledgeBase/knowledge/K006.json
ls app/data/knowledgeBase/knowledge/K027.json
# ... 12個全て確認
```

### **5. 分析開始**
K006.jsonから読み込み、layoutとcontentの分析開始

---

## 🔥 新しいセッションでの開始方法

**新しいセッションが開始された場合、以下の指示を送ってください：**

```
以下のドキュメントを順番に読んで現在のプロジェクト状況を把握してください：

1. /mnt/c/instagram-course/instagram-post-generator/セッション引き継ぎ_テンプレート設計プロジェクト状況.md
2. /mnt/c/instagram-course/instagram-post-generator/投稿タイプ別Problem-Solution構造分析.md  
3. /mnt/c/instagram-course/instagram-post-generator/Kxxx_セクションマッピング.md

読み込み完了後、Phase 1の手動分析（12個の代表例）から作業を再開してください。
```

---

## 📝 現在の課題・懸念事項

### **解決済み**
- ページ構成とテンプレートの概念混在 → 明確に分離
- セクション分割基準の曖昧さ → 「テンプレート変更」基準で統一
- レイアウトパターンの体系化 → 10パターン理論フレームワーク完成

### **未解決（次の作業で解決予定）**
- 実際のレイアウトパターン使用状況 → Phase 1で分析
- カラム内容の実態 → Phase 1で特定
- テンプレート数の最終確定 → Phase 1-2で確定

---

**このドキュメントがあれば、いつでも同じ状態からプロジェクトを再開できます。**